javascript:if(void 0===cURL)var cURL=document.location.href;else exit(0);function loadXMLDoc(e){return window.XMLHttpRequest?xhttp=new XMLHttpRequest:xhttp=new ActiveXObject("Microsoft.XMLHTTP"),xhttp.open("GET",e,!1),xhttp.send(),xhttp.responseXML}function setCookie(e,t){localStorage.setItem(e,t)}function getCookie(e){try{return localStorage.getItem(e)}catch(e){return null}}function pic(e){return"https://raw.githubusercontent.com/cncDAni2/klanhaboru/main/images/csoport/"+e+".png"}function picT(e){return"att"==e?"https://raw.githubusercontent.com/cncDAni2/klanhaboru/main/images/utility/attack.png":"https://raw.githubusercontent.com/cncDAni2/klanhaboru/main/images/utility/"+e+".png"}function distCalc(e,t){return e[0]=parseInt(e[0]),e[1]=parseInt(e[1]),t[0]=parseInt(t[0]),t[1]=parseInt(t[1]),Math.abs(Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)))}function massRename(){try{var e=document.getElementById("production_table").rows,t=prompt('Mi legyen az új név?\n\nHasználható helyettesítő karakterek:\n\t[N]: A jelenlegi falu neve \n\t[Nx,y]: x és y számok. Kivágást csinál a jelenlegi név alapján, az x-edik karaktertől y DARAB karaktert\n\t[Cx,y,z]: x,y,z számok. Sorszámot csinál, x kezdőértékkel, y léptetéssel, z számjeggyel (utóbbi max 9 lehet)\n\t[T]: A "Távolság" oszlopba írt szám, ha van. (Ha nincs és mégis írod, a pontértékkel lesz egyenlő)\n\n\tHa a legelejére [!]-t teszel, akkor nem fogja leokézni azonnal a faluneveket; ha pedig csak annyit írsz be hogy OK, akkor csak okéz.',"[!][N]");if(""==t||null==t)return;var a=!0;(r=/^(\[!\])/).test(t)&&(a=!1,t=t.substr(3,t.length));for(var n=1;n<e.length;n++)"none"!=e[n].style.display&&"none"!=e[n].cells[0].getElementsByClassName("quickedit-content")[0].style.display&&e[n].cells[0].getElementsByTagName("a")[1].click();e=document.getElementById("production_table").rows;var r,l=new Array(0,0,0,"0");if((r=/\[C[0-9]+,[0-9]+,[0-9]\]/g).test(t)){l[0]=parseInt(t.match(r)[0].split(",")[0].replace("[C",""));l[1]=parseInt(t.match(r)[0].split(",")[1]),l[2]=parseInt(t.match(r)[0].split(",")[2])}var s=/\[N[0-9]+,[0-9]+\]/g;if(s.test(t))var o=t.match(s).length;else o=0;var i="",c="";for(n=1;n<e.length;n++)if("none"!=e[n].style.display){for(c=e[n].cells[0].getElementsByClassName("quickedit-label")[0].getAttribute("data-text"),i=t.replace(/\[N\]/g,c),l[3]=l[0]+"";l[3].length<l[2];)l[3]="0"+l[3];i=i.replace(r,l[3]);for(var p=0;p<o;p++)i=i.replace(/\[N[0-9]+,[0-9]+\]/,c.substr(parseInt(i.match(s)[0].split(",")[0].replace("[N",""))-1,parseInt(i.match(s)[0].split(",")[1])));i=i.replace(/\[T\]/g,e[n].cells[1].textContent),"OK"!=t&&(e[n].cells[0].getElementsByTagName("input")[1].value=i),a&&e[n].cells[0].getElementsByTagName("input")[2].click(),l[0]+=l[1]}}catch(e){alert("Hiba történt:\n"+e)}}function ModOpenType(e,t){try{a=T.getElementsByTagName("img");for(var n=0;n<a.length;n++)a[n].style.backgroundColor="transparent";e.style.backgroundColor="brown",OPENTYPE=t,suti=getCookie("cnc_csoport"),Fsuti=suti.split(";"),Fsuti[0]=t,str=Fsuti[0];for(n=1;n<Fsuti.length;n++)str+=";"+Fsuti[n];setCookie("cnc_csoport",str)}catch(e){alert(e)}}function manager(e){if("del"==e){if(sure=confirm("Minden csoport törlődik, folytatja?"),!sure)return;localStorage.removeItem("cnc_csoport"),location.reload()}if("exp"==e&&(exp=getCookie("cnc_csoport"),displayMessage("Export","<p>Mentse el az alábbi sort, melyet később megadhat importáláskor adatainak visszállításához:</p><p style='width: 300px; word-wrap: break-word;'>"+exp+"</p>")),"imp"==e){if(input=prompt("Adja meg a korábban lementett adatot visszaállításhoz: "),null==input||""==input)return;setCookie("cnc_csoport",input,30),imp=input.match(/;[^;]+/g),G.innerHTML="";for(var t=0;t<imp.length;t++)imp[t]=imp[t].replace(/;/g,""),imp[t].search(/[^0-9]/g)>=0&&(G.innerHTML+="&nbsp;&nbsp;&nbsp; <a href='javascript: csoport(\""+imp[t]+"\");'>"+imp[t]+"</a>");kivalasztott="",frissit()}}function frissit(){try{suti=getCookie("cnc_csoport"),Fsuti=suti.split(";"),G.innerHTML="";var e="";switch(Fsuti[2][0]){case"W":e="fa";break;case"S":e="agyag";break;case"I":e="vas";break;case"M":e="a legkisebb nyerstípus";break;case"X":e="a legnagyobb nyerstípus";break;case"A":e="az átlagos nyersanyagérték"}document.getElementById("D_tanya").setAttribute("title","≥"+Fsuti[1]+" fő. Kattints a módosításhoz."),document.getElementById("D_raktar").setAttribute("title","≥"+Fsuti[2].match(/[0-9]+/g)[0]+"% telítettség, "+e+" alapján. Kattints a módosításhoz."),document.getElementById("D_pont").setAttribute("title","≥"+Fsuti[3]+" pont. Kattints a módosításhoz.");for(var t=4;t<Fsuti.length;t++){if(-1==Fsuti[t].indexOf(","))var a=Fsuti[t];else a=Fsuti[t].split(",")[0];if(a==KIVALASZTOTT)var n='style="background-color:#B0B0FF; padding:2px; margin:2px; border:1px solid black;"';else n='style="padding:2px; margin:2px; border:1px solid black;"';G.innerHTML+="<a "+n+" href='javascript: csoport(\""+a+"\");'>"+a+"</a> "}}catch(e){alert(e)}}function addFalu(e){if(""!=KIVALASZTOTT)try{var t=getCookie("cnc_csoport");sutiF=t.split(";");for(var a=!1,n=4;n<sutiF.length;n++)if(-1==sutiF[n].indexOf(",")){if(sutiF[n]==KIVALASZTOTT){a=!0;break}}else if(sutiF[n].split(",")[0]==KIVALASZTOTT)break;if(a)sutiF[n]+=","+e;else{for(var r=sutiF[n].split(","),l=!1,s=1;s<r.length;s++)r[s]==e&&(sutiF[n]=sutiF[n].replace(","+e,""),l=!0);l||(sutiF[n]+=","+e)}var o="";for(n=0;n<sutiF.length-1;n++)o+=sutiF[n]+";";setCookie("cnc_csoport",o+=sutiF[n])}catch(e){alert("Hiba faluhozzáadáskor\n"+e)}}function csoport(e){try{for(var t=document.getElementById("production_table"),a=1;a<t.rows.length;a++)try{CHECK=t.rows[a].cells[getOszlopNo("falunev")].getElementsByTagName("input")[0],CHECK.setAttribute("style","display:none")}catch(e){}""==ISHALMAZ&&(KIVALASZTOTT=e,frissit());var n,r=getCookie("cnc_csoport").split(";"),l="";ures=!1;for(a=4;a<r.length&&(r[a].indexOf(",")>-1?(ures=!1,l=r[a].split(",")[0]):(ures=!0,l=r[a]),l!=e);a++);var s=document.getElementById("production_table").rows;if(ures){for(a=1;a<s.length;a++)"none"!=(n=s[a]).style.display?regi=!0:regi=!1,uj=!1,halmaz(regi,uj)?n.setAttribute("style","display:line"):n.setAttribute("style","display:none");return}var o=getOszlopNo("falunev"),i=r[a].split(",");for(a=1;a<s.length;a++){"none"!=(n=s[a]).style.display?regi=!0:regi=!1;var c=s[a].cells[o].innerText.match(/[0-9]+(\|)[0-9]+/g);c=c[c.length-1],uj=!1;for(var p=1;p<i.length;p++)if(c==i[p]){uj=!0;break}halmaz(regi,uj)?n.setAttribute("style","display:line"):n.setAttribute("style","display:none")}return sethalmaz(""),void szamlal()}catch(e){alert("Hiba csoportkiválasztáskor:\n"+e)}}function szamlal(){try{for(var e=document.getElementById("production_table").rows,t=0,a=1;a<e.length;a++)if("none"!=e[a].style.display){t++;try{var n=e[a].cells[getOszlopNo("falunev")].textContent.match(/[0-9]+\|[0-9]+/g),r=" <i>-</i>";(n=getRelatedVillages(n=n[n.length-1])).length>0&&(r="<ul><li>"+n.join("<li>")+"</ul>"),e[a].getElementsByClassName("cnc_toolTipText")[0].innerHTML="<p><strong>"+t+".</strong> falu</p><strong>Csoportok:</strong> "+r}catch(e){}}else try{e[a].getElementsByTagName("img")[0].title=""}catch(e){}if(document.getElementById("csoportNyers")){var l=getAllNyers(!0),s="";t<e.length-1&&(s='Csoport összes nyersanyag: <img src="'+picT("holz")+'"> '+prettyNumberPrint(l[0])+' <img src="'+picT("lehm")+'"> '+prettyNumberPrint(l[1])+' <img src="'+picT("eisen")+'"> '+prettyNumberPrint(l[2])+"<br>"),s+='Átlagosan: <img src="'+picT("holz")+'"> '+prettyNumberPrint(Math.round(l[0]/t))+' <img src="'+picT("lehm")+'"> '+prettyNumberPrint(Math.round(l[1]/t))+' <img src="'+picT("eisen")+'"> '+prettyNumberPrint(Math.round(l[2]/t)),document.getElementById("csoportNyers").innerHTML=s}return e[0].cells[getOszlopNo("falunev")].innerHTML=e[0].cells[getOszlopNo("falunev")].innerHTML.replace(/\([0-9]+\)/g,"("+t+")"),t}catch(e){return alert("Számlál hiba: "+e),0}}function ujcsoport(){try{if(suti=getCookie("cnc_csoport"),nev=prompt("Mi legyen az új csoport neve?"),null==nev)return;if(nev.search(";")>=0&&(alert("A ; karakter nem megengedett, pont (.)-ra alakul át."),nev=nev.replace(";",".")),nev.search(",")>=0&&(alert("A , karakter nem megengedett, pont (.)-ra alakul át."),nev=nev.replace(",",".")),nev.search('"')>=0&&(alert('A " karakter nem megengedett, törlődik.'),nev=nev.replace('"',"")),nev.length<1)return void alert("A csoport neve nem lehet üres");Fsuti=suti.split(";");for(var e=4;e<Fsuti.length;e++)if(Fsuti[e].indexOf(",")>=0&&Fsuti[e].split(",")[0]==nev)return void alert("Ilyen nevű csoport már létezik");setCookie("cnc_csoport",suti+";"+nev),frissit()}catch(e){alert(e)}}function Dcsoport(e){try{for(var t,a=!1,n=document.getElementById("production_table"),r=1;r<n.rows.length;r++)try{CHECK=n.rows[r].cells[getOszlopNo("falunev")].firstChild,CHECK.setAttribute("style","display:none")}catch(e){}if(KIVALASZTOTT="","ossz"==e){var l=document.getElementById("production_table").rows;for(r=1;r<n.rows.length;r++)CHECK2=l[r],halmaz(a="none"!=CHECK2.style.display,!0)?CHECK2.setAttribute("style","display:line"):CHECK2.setAttribute("style","display:none")}if("tanya"==e){suti=getCookie("cnc_csoport"),t=suti.split(";")[1],t=parseInt(t);for(l=document.getElementById("production_table").rows,r=1;r<n.rows.length;r++)CHECK2=l[r],a="none"!=CHECK2.style.display,c=getOszlopNo("tanya"),halmaz(a,t>0?parseInt(CHECK2.cells[c].innerHTML.split("/")[0])>=t:parseInt(CHECK2.cells[c].innerHTML.split("/")[0])-parseInt(CHECK2.cells[c].innerHTML.split("/")[1])>=t)?CHECK2.setAttribute("style","display:line"):CHECK2.setAttribute("style","display:none")}if("raktar"==e){suti=getCookie("cnc_csoport"),t=[suti.split(";")[2][0],parseInt(suti.split(";")[2].match(/[0-9]+/g)[0],10)];for(l=document.getElementById("production_table").rows,r=1;r<n.rows.length;r++){CHECK2=l[r],a="none"!=CHECK2.style.display;var s=n.rows[r].cells[getOszlopNo("nyers")].textContent.replace(/\./g,"").match(/[0-9]+/g);switch(fa=parseInt(s[0]),agyag=parseInt(s[1]),vas=parseInt(s[2]),compare=fa,t[0]){case"W":compare=fa;break;case"S":compare=agyag;break;case"I":compare=vas;break;case"M":agyag<fa&&(compare=agyag),vas<compare&&(compare=vas);break;case"X":agyag>fa&&(compare=agyag),vas>compare&&(compare=vas);break;case"A":compare=Math.round((fa+agyag+vas)/3)}raktar=parseInt(n.rows[r].cells[getOszlopNo("raktar")].textContent),halmaz(a,compare/raktar*100>=t[1])?CHECK2.setAttribute("style","display:line"):CHECK2.setAttribute("style","display:none")}}if("pont"==e){suti=getCookie("cnc_csoport"),t=suti.split(";")[3],t=parseInt(t);for(l=document.getElementById("production_table").rows,r=1;r<n.rows.length;r++)CHECK2=l[r],halmaz(a="none"!=CHECK2.style.display,parseInt(CHECK2.cells[getOszlopNo("pont")].innerText.replace(".",""))>=t)?CHECK2.setAttribute("style","display:line"):CHECK2.setAttribute("style","display:none")}if("regexp"==e){var o=prompt("Adja meg azt a reguláris kifejezést, amely szerint a faluneveket szűrni szeretné!\nA falu neve alatt a koordináta és a kontinens szám is értendő!");if(null==o)return;var i=new RegExp(o,""),c=(l=document.getElementById("production_table").rows,getOszlopNo("falunev"));for(r=1;r<l.length;r++)CHECK2=l[r],nev=$.trim(CHECK2.cells[c].innerText),halmaz(a="none"!=CHECK2.style.display,!!i.test(nev))?CHECK2.setAttribute("style","display:line"):CHECK2.setAttribute("style","display:none")}if("tamad"==e)for(l=document.getElementById("production_table").rows,r=1;r<n.rows.length;r++){CHECK2=l[r],c=getOszlopNo("falunev"),a="none"!=CHECK2.style.display;var p=CHECK2.cells[c].innerHTML;halmaz(a,void 0!==p&&null!=p&&p.indexOf("attack.png")>0)?CHECK2.setAttribute("style","display:line"):CHECK2.setAttribute("style","display:none")}if("headtail"==e){var d=prompt("Mely falukat akarod a jelenlegi sorrendből megtartani?\nElső X falu megtartásához írj be egy számot.\nUtolsó X falu megadásához írj egy '-'-t, és aztán a számot! (pl. -20)\n\nHa tól-ig jelölést szeretnél megadni, arra is lehetőséged van szám-szám megadásával (pl. 10-40) - ekkor csak az első x-első x lehetőség nyitott.");if(null==d)return;var g=new Array(1,szamlal());try{if("-"==d[0])g[0]=szamlal()-parseInt(d.match(/[0-9]+/g)[0]),g[0]=g[0]+1;else new RegExp("[0-9]+(-)[0-9]+").test(d)?(g[0]=parseInt(d.match(/[0-9]+/g)[0]),g[1]=parseInt(d.match(/[0-9]+/g)[1])):g[1]=parseInt(d.match(/[0-9]+/g)[0])}catch(e){return void alert("Hibás megadás.")}var u=0;for(l=document.getElementById("production_table").rows,r=1;r<l.length;r++)CHECK2=l[r],"none"!=CHECK2.style.display&&(halmaz(a=!0,++u>=g[0]&&u<=g[1])?CHECK2.setAttribute("style","display:line"):CHECK2.setAttribute("style","display:none"))}if("RND"==e){l=document.getElementById("production_table").rows;var m=szamlal();if(null==(v=prompt("Mennyi falut szeretnél kiválasztani véletlenszerűen a jelenlegi látott listából?\nMaximum "+(m-1)))||""==v)return;if(""==(v=v.replace(/[^0-9]/g,"")))return;if((v=parseInt(v))>=m)return void alert("Ennyi falut nem tudok kiválasztani ("+v+")!");for(var y=0,f=new Array;f.length<v;)y=Math.floor(Math.random()*m+1),-1==f.indexOf(y)&&f.push(y);y=0;for(r=1;r<l.length;r++)CHECK2=l[r],"none"!=CHECK2.style.display&&(y++,halmaz(a=!0,-1!=f.indexOf(y))?CHECK2.setAttribute("style","display:line"):CHECK2.setAttribute("style","display:none"))}if("grafgomb"==e){if(null==(h=prompt("Mely falukhoz viszonyítva legyenek a távolságok?"))||""==h)return;var v,h=h.match(/[0-9]{1,3}(\|)[0-9]{1,3}/g);if(null==(v=prompt("Ezen falukhoz mennyi legközelebbit írjak ki?"))||""==v)return;if(""==(v=v.replace(/[^0-9]/g,"")))return;v=parseInt(v);m=(l=document.getElementById("production_table").rows).length;if(h.length*v>=m)return void alert("Nem áll rendelkezésre elegendő falu, avagy minden falu listázódna");var b=!1;b=null!=document.getElementById("tav");for(r=0;r<l.length;r++){if(b)z=l[r].cells[getOszlopNo("tav")];else var z=l[r].insertCell(getOszlopNo("falunev")+1);0!=r?z.innerHTML="---":(z.innerHTML='<b><a href=\'javascript: rendez(false,"tav", "tav")\'>Távolság</a>/<a href=\'javascript: rendez(false,"falu","tav")\'>Falu</a></b>',z.setAttribute("id","tav"))}for(var k=new Array,T=0;T<h.length;T++){var E=new Array;E[0]=-1;for(r=1;r<l.length;r++){N=(N=l[r].cells[0].textContent.match(/[0-9]{1,3}(\|)[0-9]{1,3}/g))[N.length-1],E[r]=-1,k.indexOf(N)>-1||(E[r]=roundNumber(distCalc(h[T].split("|"),N.split("|")),2))}for(r=0;r<v;r++){for(var A=-1,I=0;I<E.length;I++)-1!=E[I]&&(-1!=A?E[I]<E[A]&&(A=I):A=I);var N;l[A].cells[getOszlopNo("tav")].innerHTML=E[A]+"/"+h[T],N=(N=l[A].cells[0].textContent.match(/[0-9]{1,3}(\|)[0-9]{1,3}/g))[N.length-1],k.push(N),E[A]=-1}}for(r=1;r<l.length;r++)"---"==l[r].cells[getOszlopNo("tav")].innerHTML?l[r].setAttribute("style","display:none"):l[r].setAttribute("style","display:line");rendez(!1,"falu","tav")}return sethalmaz(""),frissit(),void szamlal()}catch(e){alert(e)}}function halmaz(e,t){return""==ISHALMAZ?t:(NEG2&&(t=!t),"metszet"==ISHALMAZ?!(!e||!t):"unio"==ISHALMAZ?!(!e&&!t):"kulonbseg"==ISHALMAZ?!!e&&(!e||!t):t)}function sethalmaz(e){if("negalt"!=e&&("negalt2"==e?NEG2=!NEG2:(ISHALMAZ=ISHALMAZ==e?"":e,""==e&&(NEG2=!1))),document.getElementById("halmazallapot")&&(document.getElementById("halmazallapot").innerHTML="Halmazművelet: <b>"+ISHALMAZ+"</b><br>Negált 2? <b>"+NEG2+"</b>"),"negalt"==e){for(var t=document.getElementById("production_table"),a=1;a<t.rows.length;a++)CHECK=t.rows[a].cells[getOszlopNo("falunev")].firstChild,CHECK.setAttribute("style","display:none");KIVALASZTOTT="";for(a=1;a<t.rows.length;a++){var n=t.rows[a];"none"!=n.style.display?n.setAttribute("style","display:none"):n.setAttribute("style","display:line")}szamlal()}}function szerkeszt(){try{if(HALMAZ="",""==KIVALASZTOTT)return;for(var e=document.getElementById("production_table"),t=getOszlopNo("falunev"),a=1;a<e.rows.length;a++)CHECK=e.rows[a].cells[t].firstChild,CHECK.setAttribute("style","display:line"),CHECK.checked=!1,CHECK2=e.rows[a],CHECK2.setAttribute("style","display:line");suti=getCookie("cnc_csoport"),sutiF=suti.split(";");for(a=4;a<sutiF.length;a++)if(-1==sutiF[a].indexOf(",")){if(sutiF[a]==KIVALASZTOTT)return}else sutiF[a].split(",")[0]==KIVALASZTOTT&&(no=a);for(a=1;a<e.rows.length;a++)koord=e.rows[a].cells[t].innerText.match(/[0-9]+(\|)[0-9]+/g),koord=koord[koord.length-1],CHECK2=e.rows[a].cells[t].firstChild,sutiF[no].indexOf(koord)>0&&(CHECK2.checked=!0)}catch(e){alert(e)}}function atnevez(){try{if(""==KIVALASZTOTT)return void alert("Csak általad létrehozott és kijelölt csoportot tudsz átnevezni");if(suti=getCookie("cnc_csoport"),nev=prompt("Mi legyen az új csoport neve?",KIVALASZTOTT),nev==KIVALASZTOTT)return;if(null==nev)return;if(nev.search(";")>=0&&(alert("A ; karakter nem megengedett, pont (.)-ra alakul át."),nev=nev.replace(";",".")),nev.search(",")>=0&&(alert("A , karakter nem megengedett, pont (.)-ra alakul át."),nev=nev.replace(",",".")),nev.search('"')>=0&&(alert('A " karakter nem megengedett, törlődik.'),nev=nev.replace('"',"")),nev.length<1)return void alert("A csoport neve nem lehet üres");Fsuti=suti.split(";");for(var e=4;e<Fsuti.length;e++)if(Fsuti[e].indexOf(",")>=0){if(Fsuti[e].split(",")[0]==nev)return void alert("Ilyen nevű csoport már létezik")}else if(Fsuti[e]==nev)return void alert("Ilyen nevű csoport már létezik");suti=suti.replace(";"+KIVALASZTOTT,";"+nev),setCookie("cnc_csoport",suti)}catch(e){alert(e)}frissit()}function torol(){try{if(""==KIVALASZTOTT)return;if(!confirm("Biztosan törli ezt a csoportot?\n"+KIVALASZTOTT))return;suti=getCookie("cnc_csoport"),Fsuti=suti.split(";"),str=Fsuti[0];for(var e=1;e<Fsuti.length;e++)e>3?-1==Fsuti[e].indexOf(",")?Fsuti[e]!=KIVALASZTOTT&&(str+=";"+Fsuti[e]):Fsuti[e].split(",")[0]!=KIVALASZTOTT&&(str+=";"+Fsuti[e]):str+=";"+Fsuti[e];return setCookie("cnc_csoport",str),void frissit()}catch(e){alert(e)}}function mod(e){if(1==e){if(erre=prompt("Adja meg az új értéket.\nTanyahelyes érték (50-30000)\nJelentése: azon faluk, melyek lakossága ezen értékű, vagy feletti.\n\nSpeciális lehetőség: - jel utáni szám jelentése, hogy minimum ennyi hiányzik a teljes tanyaértékhez."),null==erre)return;try{if(isNaN(erre))throw"error";if(erre=parseInt(erre),erre>3e4)throw"error"}catch(e){return void alert("Hibásan megadott érték")}}if(2==e)return displayMessage("Raktárszűrő",'\t\t<form name="raktarForm">\t\tMi alapján akarsz szűrni?<br>\t\t\t&nbsp;&nbsp;&nbsp;<input type="radio" name="cnc_rak" value="M"> Legkisebb nyersanyagtípus<br>\t\t\t&nbsp;&nbsp;&nbsp;<input type="radio" name="cnc_rak" value="X" checked> Legnagyobb nyersanyagtípus<br>\t\t\t&nbsp;&nbsp;&nbsp;<input type="radio" name="cnc_rak" value="A"> Átlagos nyersanyagérték<br>\t\t\t&nbsp;&nbsp;&nbsp;<input type="radio" name="cnc_rak" value="W"> <span class="res wood" style="width: 18px;height: 15px;display: inline-block;"></span> Fa<br>\t\t\t&nbsp;&nbsp;&nbsp;<input type="radio" name="cnc_rak" value="S"> <span class="res stone" style="width: 18px;height: 15px;display: inline-block;"></span> Agyag<br>\t\t\t&nbsp;&nbsp;&nbsp;<input type="radio" name="cnc_rak" value="I"> <span class="res iron" style="width: 18px;height: 15px;display: inline-block;"></span> Vas<br>\t\t\tMekkora %-os telítettség legyen listázva? ≥<input type="text" name="val" size="2">%<br>\t\t\t<button type="button" onclick="set_raktarszuro('+e+')">Beállít</button>\t\t</form>'),document.forms.raktarForm.cnc_rak.value=getCookie("cnc_csoport").split(";")[e][0],void(document.forms.raktarForm.val.value=getCookie("cnc_csoport").split(";")[e].match(/[0-9]+/g)[0]);if(3==e){if(erre=prompt("Adja meg az új értéket.\nPontérték (50-13000)\nJelentése: azon faluk, melyek a megadott pont feletti értékkel rendelkeznek."),null==erre)return;try{if(isNaN(erre))throw"error";if(erre=parseInt(erre),erre>13e3||erre<50)throw"error"}catch(e){return void alert("Hibásan megadott érték")}}suti=getCookie("cnc_csoport"),Fsuti=suti.split(";"),Fsuti[e]=erre,setCookie("cnc_csoport",Fsuti.join(";")),frissit()}function set_raktarszuro(e){var t=[document.forms.raktarForm.cnc_rak.value,document.forms.raktarForm.val.value];""==t[0]||null==t[0]||""==t[1]||isNaN(t[1])||parseInt(t[1],10)<1||parseInt(t[1],10)>100?alert("Érvénytelen megadás"):(suti=getCookie("cnc_csoport"),Fsuti=suti.split(";"),Fsuti[e]=t.join(""),setCookie("cnc_csoport",Fsuti.join(";")),frissit(),displayMessage("disable"))}function getOszlopNo(e){tabla=document.getElementById("production_table").rows[0];for(var t=0;t<tabla.cells.length;t++)if(tabla.cells[t].getAttribute("id")==e)return t;return-1}function megnyit(){try{var e=szamlal();if(e>25&&!confirm(e+" lapot készült megnyitni. Biztos?"))return;var t="",a=document.getElementById("production_table");oszlopno=getOszlopNo("falunev"),openedREFS=[],TABHELPER=0,TABHELPER_LIST=[];for(var n=1;n<a.rows.length;n++)"none"!=a.rows[n].style.display&&(t=(t=a.rows[n].cells[getOszlopNo("falunev")].getElementsByTagName("a")[0].getAttribute("href")).replace("overview",OPENTYPE),TABHELPER_LIST.push(t));for(n=0;n<TABHELPER_LIST.length;n++)setTimeout((function(){openedREFS.push(window.open(TABHELPER_LIST[TABHELPER])),TABHELPER++}),(150+100*Math.random())*n);displayMessage("Megnyitott lapok",TABHELPER_LIST.length+'lap megnyitva.<br><button type="button" onclick="closeAllTab()">Kattints ide a bezáráshoz</button>');var r=10;function l(e){var t=!0;if(!(--r<1)){for(var a=0;a<e.length;a++)e[a].document&&e[a].document.getElementById("serverTime")&&e[a].document.getElementById("serverTime").innerHTML.length>4?referenceCsoport(e[a]):t=!1;t||setTimeout((function(){l(e)}),1e3)}}setTimeout((function(){l(openedREFS)}),200*TABHELPER_LIST.length)}catch(s){alert("Open_ERROR:"+s)}}function closeAllTab(){for(var e=0;e<openedREFS.length;e++)openedREFS[e].close();displayMessage("","disable")}function referenceCsoport(e){if(!e.document.getElementById("cnc_csoport_box")){var t=getRelatedVillages(e.game_data.village.coord),a=e.document.createElement("div");a.setAttribute("id","cnc_csoport_box");var n='<div id="cnc_csoport" style="position: fixed; top: 100px; left: 30%; z-index: 1; background: rgb(51, 170, 85); padding: 0px 0px 10px 0px;"><div id="cnc_csoport_header" style="padding: 5px; background: #379; cursor: move; margin-bottom: 10px; font-weight: bold; border-bottom: 1px solid black;">Csoportok:</div>';if(0==t.length)n+="<i>Ez a falu nincs csoportba felvéve</i>";else for(var r=0;r<t.length;r++)n+='<a href="#" style="padding:3px; margin:0 3px; border:1px solid black;">'+t[r]+"</a>";n+="</div>",a.innerHTML=n,e.document.body.insertBefore(a,e.document.body.firstChild),e.$("#cnc_csoport").draggable({handle:"#cnc_csoport_header"})}}function getRelatedVillages(e){for(var t=localStorage.getItem("cnc_csoport").split(";"),a=[],n=4;n<t.length;n++)for(var r=t[n].split(","),l=1;l<r.length;l++)if(e==r[l]){a.push(r[0]);break}return a}function iskivalaszt(e){return suti=getCookie("cnc_csoport"),suti.split(";")[0]==e?'style="background-color:brown"':""}function mentes(){var e=document.getElementById("production_table").rows,t=getOszlopNo("falunev"),a=getCookie("cnc_csoport");if(nev=prompt("Mi legyen ennek a falucsoportnak a neve?"),null!=nev)if(nev.search(";")>=0&&(alert("A ; karakter nem megengedett, pont (.)-ra alakul át."),nev=nev.replace(";",".")),nev.search(",")>=0&&(alert("A , karakter nem megengedett, pont (.)-ra alakul át."),nev=nev.replace(",",".")),nev.search('"')>=0&&(alert('A " karakter nem megengedett, törlődik.'),nev=nev.replace('"',"")),nev.length<1)alert("A csoport neve nem lehet üres");else{Fsuti=a.split(";");for(var n=4;n<Fsuti.length;n++)if(Fsuti[n].indexOf(",")>=0&&Fsuti[n].split(",")[0]==nev)return void alert("Ilyen nevű csoport már létezik");var r=";"+nev;for(n=1;n<e.length;n++)if(CHECK2=e[n],"none"!=CHECK2.style.display){var l=CHECK2.cells[t].innerText.match(/[0-9]+(\|)[0-9]+/g);r+=","+l[l.length-1]}setCookie("cnc_csoport",a+=r),frissit()}}function szinez(){try{oszl=getOszlopNo("falunev");var e=document.getElementById("production_table").rows;rnd=Math.floor(16*Math.random()),szin=["black","maroon","green","olive","navy","purple","teal","gray","silver","red","lime","yellow","blue","fuchsia","aqua","white"][rnd];for(var t=!0,a=1;a<e.length;a++)CHECK2=e[a],"none"!=CHECK2.style.display&&(t=!1,CHECK2.cells[oszl].setAttribute("style","background-color: "+szin+" !important"));if(t)for(a=1;a<e.length;a++)CHECK2=e[a],CHECK2.cells[oszl].setAttribute("style","background-color:none;border:none;")}catch(e){alert(e)}}function szinez1(e){try{var t=new Array("","purple","yellow","black"),a=t.indexOf(e.parentNode.style.backgroundColor);return++a>3&&(a=0),void e.parentNode.setAttribute("style","background-color: "+t[a]+" !important")}catch(e){alert(e)}}function toredezett(){try{suti=getCookie("cnc_csoport"),sutiORIGINAL=suti,oszl=getOszlopNo("falunev");var e=document.getElementById("production_table").rows;sutiF=suti.split(";"),faluk=new Array;for(var t=4;t<sutiF.length;t++)if(sutiF[t].indexOf(",")>=0){addon=sutiF[t].split(",");for(var a=1;a<addon.length;a++)faluk=faluk.concat(addon[a])}for(var n=new Array,r=1;r<e.length;r++)koord=e[r].cells[oszl].innerText.match(/[0-9]+(\|)[0-9]+/g),n=n.concat(koord[koord.length-1]);var l=!1,s="";for(r=0;r<faluk.length;r++){for(l=!1,t=0;t<n.length;t++)if(faluk[r]==n[t]){l=!0;break}l||(suti=suti.replace(","+faluk[r],""),s+=faluk[r]+", ")}return""==s?alert("Nincsenek olyan faluk a lementett csoportleosztásba, amik nem léteznek nálad!"):alert("Egy vagy több falut kitöröltem a csoportleosztásból, mivel ilyenek nem léteznek:\n"+s+"\n\n Ha biztonsági mentést szeretne végezni a törlés előtt, mentse el az alábbi szöveget, melyet importáláskor később megadhat:\n"+sutiORIGINAL),void setCookie("cnc_csoport",suti)}catch(e){alert(e)}}function roundNumber(e,t){return Math.round(e*Math.pow(10,t))/Math.pow(10,t)}function politavolsag(e){try{if(void 0===e)e=!1;var t=new Array,a=document.getElementById("production_table").rows,n="",r="";if(.75*a.length<szamlal())r=game_data.village.coord;else for(var l=1;l<a.length;l++)"none"!=a[l].style.display&&(r+=(n=a[l].cells[getOszlopNo("falunev")].innerText.match(/[0-9]+(\|)[0-9]+/g))[n.length-1]+" ");if(null==(r=e||prompt("Mely falukhoz viszonyítva szeretnéd a távolságokat kiíratni?\n(A kiírt távolság a listában szereplő faluk közül a legközelebbihez lesz mérve.\nEzt a falut megnézheted, ha ráteszed az egered a távolságra.)",r))||""==r)return;try{if((r=r.match(/[0-9]+(\|)[0-9]+/g)).length<1)throw"error"}catch(A){return void alert("Érvénytelen koordináta megadás\n"+r)}var s=!1;s=null!=document.getElementById("tav");var o=document.getElementById("production_table").rows,i=-1,c=(n=0,"");for(l=0;l<o.length;l++){var p;i=-1,p=s?o[l].cells[getOszlopNo("tav")]:o[l].insertCell(getOszlopNo("falunev")+1);var d="",g="Távolság";if(e&&(g="Fontosság",d="fontos"),0!=l){JFalu=o[l].cells[getOszlopNo("falunev")].innerText.match(/[0-9]+(\|)[0-9]+/g),JFalu=JFalu[JFalu.length-1].split("|");for(var u=0;u<r.length;u++)((n=roundNumber(distCalc(r[u].split("|"),JFalu),2))<i||-1==i)&&(i=n,c=r[u]);t.push(c);var m=i*(1/SPEED)*(1/UNITS),y=18*m,f=22*m,v=9*m,h=10*m,b=11*m,z=30*m,k=35*m;p.setAttribute("class","cnc_toolTip cnc_toolTip_middle");var T=document.createElement("span");T.setAttribute("class","cnc_toolTipText"),e?(p.innerHTML='<div class="tavolsag">'+c+"</div>",T.innerHTML="A legközelebbi falu.<br>Távolsága: "+i+" mező"):(p.innerHTML='<div class="tavolsag">'+i+"</div>",T.innerHTML="Legközelebbi: "+c+"<br>Távolság Időben (óra:perc)"),T.innerHTML+='<table class="tavTable"><tbody><tr><td>Lándzsás</td><td>'+parseInt(y/60)+":"+E(parseInt(y) % 60)+"</td></tr><tr><td>Kardforgató</td><td>"+parseInt(f/60)+":"+E(parseInt(f) % 60)+"</td></tr><tr><td>Felderítő</td><td>"+parseInt(v/60)+":"+E(parseInt(v) % 60)+"</td></tr><tr><td>Könnyűlovas</td><td>"+parseInt(h/60)+":"+E(parseInt(h) % 60)+"</td></tr><tr><td>Nehézlovas</td><td>"+parseInt(b/60)+":"+E(parseInt(b) % 60)+"</td></tr><tr><td>Kos</td><td>"+parseInt(z/60)+":"+E(parseInt(z) % 60)+"</td></tr><tr><td>Főnemes</td><td>"+parseInt(k/60)+":"+E(parseInt(k) % 60)+"</td></tr></tbody></table>",p.appendChild(T)}else p.innerHTML="<a href=\"javascript: rendez(false, '"+d+"', 'tav')\"><b>"+g+"</b></a>",p.setAttribute("id","tav")}return t;function E(e){return e<10?"0"+e:e}}catch(I){alert(I)}}function smasher_sulyoz(e,t,a,n){for(var r=0,l=0;l<e.length;l++)for(var s=0;s<t.length+1;s++)if(s==t.length){if(""==a)break;distCalc(a.split("|"),e[l].split("|"))<n&&r++}else if(distCalc(t[s].split("|"),e[l].split("|"))<n){r++;break}return r}function smasher(e){try{for(var t=new Array,a=document.getElementById("production_table").rows,n=1;n<a.length;n++)d=a[n].cells[getOszlopNo("falunev")].innerText.match(/[0-9]+(\|)[0-9]+/g),t.push(d[d.length-1]);if(!e){var r=new Array(0,0);for(n=0;n<t.length;n++)r[0]+=parseInt(t[n].split("|")[0]),r[1]+=parseInt(t[n].split("|")[1]);return r[0]=Math.round(r[0]/a.length),r[1]=Math.round(r[1]/a.length),void displayMessage("Hálózat-kereső beállítások",'<table>\t\t<tr><td>Melyek azok amik biztos csomópontok?<br>Mindenképp adj meg 1-et, és létező falukat.<br>Jelenlegi a bázisod közepe, ami <u>nem biztos hogy létező falu</u>!)</td><td><textarea cols="35" rows="3">'+r.join("|")+'</textarea></td></tr>\t\t<tr><td>Melyek azok amiket nem szeretnél csomópontnak?<br><i>Ettől függetlenül lehet hogy a része lesz</i></td><td><textarea cols="35" rows="3"></textarea></td></tr>\t\t<tr><td>Max hány faluig menjünk?</td><td><input size="3" value="20"></td></tr>\t\t<tr><td>Mekkora táv legyen a faluk között?</td><td><input size="3" value="8"></td></tr></table>\t\t<input type="submit" onclick=smasher(true) value="Keresd"><br><div id="smasherRes" style="display: none; margin: 10px auto 0 auto; width: 300px; padding: 5px; background-color: green; color:black;"></div>')}var l=new Array,s=new Array;if(""==(r=document.getElementById("uzi").getElementsByTagName("textarea")[0].value)||null==r||-1==r.indexOf("|"))return;s=r.match(/[0-9]+(\|)[0-9]+/g);var o=document.getElementById("uzi").getElementsByTagName("input")[1].value;if(""==o||null==o||isNaN(o))return;var i=document.getElementById("uzi").getElementsByTagName("input")[2].value;if(""==i||null==i||isNaN(i))return;var c=document.getElementById("uzi").getElementsByTagName("textarea")[1].value;try{c=c.match(/[0-9]+(\|)[0-9]+/g)}catch(e){c=new Array}for(o=parseInt(o),i=parseInt(i);s.length<o&&t.length>1;){var p=-1,d=0;l=new Array;for(n=0;n<t.length;n++){p=-1;for(var g=0;g<s.length;g++)((d=roundNumber(distCalc(s[g].split("|"),t[n].split("|")),2))<p||-1==p)&&(p=d);l.push(p)}var u=l.max();if(u<=i)break;var m=new Array;for(n=0;n<t.length;n++)l[n]<=i?m[n]=-120:(m[n]=smasher_sulyoz(t,s,t[n],i),t[n].indexOf(c)>-1&&(m[n]-=100));var y=m.max();for(n=0;n<m.length;n++)if(m[n]==y){s.push(t[n]);break}for(n=t.length-1;n>-1;n--)l[n]<i&&t.splice(n,1)}falulista_import(s.join(", ")),centerFinder(s.join(", ")),$("#smasherRes").show(),alert(t),t.length<2&&(u="Kevesebb mint "+i),document.getElementById("smasherRes").innerHTML="<b>Eredmény:</b><br><u>Max táv:</u> "+u+"<br><u>Faluk száma:</u> "+s.length+" falu"}catch(e){alert(e)}}function centerFinder(e){try{if(!e||void 0===e)e=prompt("Add meg, mely falukat vizsgáljam meg. \n Eredményül kiírom, mennyi falud tartozik hozzá legközelebb a listából");if(-1==e.indexOf("|"))return;e=e.match(/[0-9]+(\|)[0-9]+/g);new Array;for(var t=politavolsag(e.join(", ")),a=document.getElementById("production_table").rows,n=getOszlopNo("tav"),r=getOszlopNo("falu"),l=1;l<a.length;l++){var s=a[l].cells[r].innerText.match(/[0-9]+(\|)[0-9]+/g);s=s[s.length-1];var o=e.indexOf(s);if(-1!=o){for(var i=a[l].cells[n],c=0,p=0;p<t.length;p++)t[p]==e[o]&&c++;i.innerHTML=c,i.style.background="rgb(100,100,255)"}}rendez(!1,"fontos","tav")}catch(e){}}function rendez(e,t,a){try{var n=document.getElementById("production_table"),r=getOszlopNo(a),l=n.rows,s=new Array,o=new Array,i=new Array,c=0;l[0].cells.length!=l[l.length-1].cells.length&&(c=1);var p=$.trim(l[1].cells[r].innerText).replace(" ",""),d="";if(l[1].cells[r].getElementsByClassName("tavolsag").length>0)d="fontos"==t?"szoveg":"tavolsag";else if(isNaN(p)&&isNaN(p.replace(/\./g,""))){console.info("isNaN");var g=new RegExp(/^[0-9]+(\/)[0-9]+$/g),u=new RegExp(/^[0-9\.]+(\/)[0-9\|]+$/g);g.test(p)?d="peres1":"falu"==t&&u.test(p)&&(d="falu_peres2"),(g=new RegExp(/^[0-9][0-9](\:)[0-9][0-9](\:)[0-9][0-9]$/g)).test(p)&&(d="ido")}else console.info("szám lesz, a pont is OKÉ"),""==p&&(d="nyersOssz",0==l[1].cells[r].getElementsByTagName("div").length&&(d="szoveg")),""==d&&(d="szam"),"szam"==d&&-1==p.indexOf(".")&&0==l[1].cells[r].getElementsByClassName("grey").length&&(d="szam_Float"),(l[1].cells[r].innerHTML.indexOf('class="rename-icon"')>0||l[1].cells[r].innerHTML.indexOf("screen=info_player")>0)&&(d="szoveg");"wood"==t&&(d="nyers1"),"stone"==t&&(d="nyers2"),"iron"==t&&(d="nyers3"),""==d&&(d="szoveg"),console.info("Type:",d);for(var m=1;m<l.length-c;m++){switch(d){case"szoveg":s[m-1]=$.trim(l[m].cells[r].innerText);break;case"peres1":s[m-1]=parseInt(l[m].cells[r].innerText.split("/")[0]);break;case"peres2":s[m-1]=parseInt(l[m].cells[r].innerText.split("/")[1]);break;case"falu_peres2":"---"===l[m].cells[r].innerText?s[m-1]=0:s[m-1]=parseInt(l[m].cells[r].innerText.split("/")[1].replace("|",""));break;case"nyers1":s[m-1]=parseInt(l[m].cells[r].innerText.replace(/\./g,"").match(/[0-9\-]+/g)[0]);break;case"nyers2":s[m-1]=parseInt(l[m].cells[r].innerText.replace(/\./g,"").match(/[0-9\-]+/g)[1]);break;case"nyers3":s[m-1]=parseInt(l[m].cells[r].innerText.replace(/\./g,"").match(/[0-9\-]+/g)[2]);break;case"nyersOssz":s[m-1]=parseFloat(l[m].cells[r].getElementsByTagName("div")[0].style.width.replace("px",""));break;case"ido":parseInt(l[m].cells[r].innerText.split(":")[0])<10?s[m-1]="0"+l[m].cells[r].innerText:s[m-1]=l[m].cells[r].innerText;break;case"szam":s[m-1]=parseInt(l[m].cells[r].innerText.replace(/\./g,""));break;case"szam_Float":s[m-1]=parseFloat(l[m].cells[r].innerText);break;case"tavolsag":s[m-1]=parseFloat(l[m].cells[r].getElementsByClassName("tavolsag")[0].innerText);break;default:return void alert("Nem értelmezhető mi szerint kéne rendezni.")}o[m-1]=l[m],i[m-1]=m-1}for(m=0;m<s.length;m++){for(var y=m,f=m;f<s.length;f++)e?s[f]>s[y]&&(y=f):s[f]<s[y]&&(y=f);var v=s[m];s[m]=s[y],s[y]=v;v=i[m];i[m]=i[y],i[y]=v}for(m=l.length-1;m>0;m--)n.deleteRow(m);for(m=0;m<s.length;m++)n.appendChild(o[i[m]]);t||(t="");var h=0;switch(t){case"tav":case"wood":h=0;break;case"falu":case"stone":h=1;break;case"iron":h=2;break;default:h=function(e){return"falunev"==e?1:0}(a)}document.getElementById(a).getElementsByTagName("a")[h].setAttribute("href","javascript: rendez("+!e+',"'+t+'", "'+a+'");'),szamlal()}catch(e){alert("Hiba rendezéskor:\n"+e)}}function warningMeter(e){try{if(!e)return void displayMessage("Veszély Indikátor",'<table>\t\t<tr><td>Adj meg falukat, melyek veszélyt jelentenek falvaidra</td><td><textarea cols="35" rows="3"></textarea></td></tr>\t\t<tr><td>Mekkora távolságra vetítve jelentenek veszélyt?<br></td><td><input size="3" value="6"></td></td></tr></table>\t\tEredményül kiírja, hogy az egyes faluid körzetébe mennyi veszélyesnek ítélt falu van.<br><br>\t\t<input type="submit" onclick=warningMeter(true) value="Keresd">');var t=document.getElementById("uzi").getElementsByTagName("textarea")[0].value;if(-1==t.indexOf("|"))return;t=t.match(/[0-9]+(\|)[0-9]+/g);var a=document.getElementById("uzi").getElementsByTagName("input")[1].value;if(isNaN(a))return;a=parseInt(a,10);for(var n,r=document.getElementById("production_table").rows,l=new Array,s=getOszlopNo("falunev"),o=1;o<r.length;o++)n=r[o].cells[s].innerText.match(/[0-9]+(\|)[0-9]+/g),l.push(n[n.length-1]);var i,c,p,d=!1,g=!1;d=null!=document.getElementById("tav"),g=null!=document.getElementById("dangerRatio"),s=getOszlopNo("tav");var u,m,y,f,v=getOszlopNo("dangerRatio"),h=getOszlopNo("falunev"),b={};for(o=0;o<r.length;o++)if(i=d?r[o].cells[s]:r[o].insertCell(h+1),c=g?r[o].cells[v]:r[o].insertCell(h+2),0!=o){b[getFaluId(r[o].cells[h])]={2:[0,0],4:[0,0],6:[0,0],8:[0,0],10:[0,0]},y=b[getFaluId(r[o].cells[h])],n=0;for(var z=0;z<t.length;z++)T(y,"enemy",p=distCalc(t[z].split("|"),l[o-1].split("|"))),p<=a&&n++;i.innerHTML=n;for(z=0;z<l.length;z++)z+1!=o&&T(y,"ally",p=distCalc(l[o-1].split("|"),l[z].split("|")));for(var k in c.setAttribute("class","cnc_toolTip"),(u=document.createElement("span")).setAttribute("class","cnc_toolTipText"),f=[0,0,0],m='Ezen falu körüli faluk száma: <table class="tavTable"><tbody>\t\t<tr><td></td><td>Saját</td><td>Ellenséges</td><td>%</td></tr>',y)f[0]+=y[k][0],f[1]+=y[k][1],f[2]+=E(parseInt(k,10),f),m+="<tr><td>"+k+" mezőn belül</td><td>"+f[1]+"</td><td>"+f[0]+"</td><td>"+A(f)+"%</td></tr>";m+="</tbody></table>",u.innerHTML=m,c.innerHTML=f[2],c.appendChild(u)}else i.innerHTML="<a href=\"javascript: rendez(false, '', 'tav')\"><b>Közeli faluk</b></a>",i.setAttribute("id","tav"),c.innerHTML="<a href=\"javascript: rendez(false, '', 'dangerRatio')\"><b>Veszély-index</b></a>",c.setAttribute("id","dangerRatio");function T(e,t,a){var n=0;a<=2?n=2:a<=4?n=4:a<=6?n=6:a<=8?n=8:a<=10&&(n=10),0!=n&&("enemy"==t?e[n][0]++:e[n][1]++)}function E(e,t){if(t[0]+t[1]==0)return 0;var a=Math.round(t[0]/(t[0]+t[1])*100);switch(e){case 2:a*=10;break;case 4:a*=6;break;case 6:a*=4;break;case 8:a*=2;break;case 10:a*=1;break;default:console.error("Invalid mezotav:",e)}return a}function A(e){return e[0]+e[1]==0?100:Math.round(e[1]/(e[0]+e[1])*100)}rendez(!0,"","tav")}catch(I){alert("Hiba"+I)}}function getFaluId(e){return e.getElementsByTagName("a")[0].href.match(/village=[0-9]+/g)[0].replace("village=","")}function displayMessage(e,t){try{if("disable"==e||"disable"==t)return void $("#uzi").hide();document.getElementById("uzi").innerHTML='<div style="background: rgba(255,255,0,0.1); cursor: move; margin-bottom: 10px; padding: 5px;" id="uzi_drag"><p align="left" style="margin: 0;display:inline-block; font-weight: bold">'+e+'</p><p align="right" style="float:right; margin: 0; display:inline-block;"><input type="button" onclick=displayMessage("","disable") style="font-weight:bold;color:#FFFFFF;background-color:#FF0000; border-style:double;border-color:#666666;"  title="Bezár" value="X"></p></div>'+t,$("#uzi").show()}catch(e){alert(e)}}function falulista_export(e){try{for(var t=document.getElementById("production_table").rows,a="",n='<textarea cols="40" rows="20" onclick="this.select()" onmouseover="this.select()">',r=1;r<t.length;r++)if("none"!=t[r].style.display)switch(a=t[r].cells[getOszlopNo("falunev")].innerText.match(/[0-9]+(\|)[0-9]+/g),e){case"BB":n+="[coord]"+a[a.length-1]+"[/coord]\n";break;case"ujsor":n+=a[a.length-1]+"\n";break;case"egysor":n+=a[a.length-1]+" "}displayMessage("Falulista",n+="</textarea>")}catch(e){alert(e)}}function addExFalu(){displayMessage("Extra falu szimuláció",'<form name="addExFalu">Adj meg falukat, amiket látni szeretnél, mintha a te faluid lennének.<br>Csak koordináták megadására van lehetőség, a többi adat a listád legelső sorából lesz másolva!<br><i>A hozzáadott falukra kattintva a térkép nyílik meg új lapon, a faluval középpontba</i><br><br>Faluk: <input name="exFaluk" placeholder="xxx|xxx xxx|xxx ..."><br><input type="radio" name="exType" value="E">Kiegészít<br><input type="radio" checked name="exType" value="S">Lecserél<br><br><button type="button" onclick="onAddExFalu()">Hozzáad</button></form>')}function onAddExFalu(){var e=document.forms.addExFalu,t=document.getElementById("production_table");if(t.rows.length<2)alert("Legalább 1 listázott falu szükséges. Frissítsd az oldalt.");else{var a,n,r=t.rows[1],l=e.exFaluk.value.match(/[0-9]{1,3}\|[0-9]{1,3}/g);if(!(l.length<1)){if("S"==e.exType.value)for(;t.rows.length>1;)t.deleteRow(-1);for(var s=0;s<l.length;s++)n=l[s].split("|"),(a=r.cloneNode(!0)).cells[0].getElementsByTagName("a")[0].href=a.cells[0].getElementsByTagName("a")[0].href.replace(/x=[0-9]+&y=[0-9]+/g,"x="+n[0]+"&y="+n[1]).replace("screen=overview","screen=map&x="+n[0]+"&y="+n[1]),a.cells[0].getElementsByTagName("a")[0].setAttribute("target","_BLANK"),a.cells[0].getElementsByClassName("quickedit-label")[0].innerHTML="Külső falu ("+l[s]+") K"+n[1][0]+n[0][0],t.appendChild(a);szamlal(),displayMessage("","disable")}}}function falulista_import(e){try{if(e)t=e;else var t=prompt("Add meg a falulistát, amit szeretnél látni.\nElválasztás nem számít");if(null==t||""==t||-1==t.search(/[0-9]+(\|)[0-9]+/g))return;t=t.match(/[0-9]+(\|)[0-9]+/g);for(var a=document.getElementById("production_table").rows,n=getOszlopNo("falunev"),r=!1,l=1;l<a.length;l++){var s=a[l],o=$.trim(s.cells[n].innerText).match(/[0-9]+(\|)[0-9]+/g);o=o[o.length-1],"none"!=s.style.display?regi=!0:regi=!1,r=!1;for(var i=0;i<t.length;i++)if(t[i]==o){r=!0;break}halmaz(regi,r)?s.setAttribute("style","display:line"):s.setAttribute("style","display:none")}sethalmaz(""),frissit(),szamlal()}catch(e){alert(e)}}function kivag(){try{for(var e=document.getElementById("production_table").rows,t=e.length-1;t>0;t--)"none"==e[t].style.display&&document.getElementById("production_table").deleteRow(t);return}catch(e){alert(e)}}function krit(){try{var e=prompt("Kritikus nyersanyagszint?",5e4);e=parseInt(e),krintp2=-1*e;for(var t=document.getElementById("production_table").rows,a=1;a<t.length;a++){if("none"!=t[a].style.display)var n=!0;else n=!1;var r=parseInt(t[a].cells[getOszlopNo("gazdType")].getElementsByTagName("span")[0].innerText.replace(/\./g,"")),l=parseInt(t[a].cells[getOszlopNo("gazdType")].getElementsByTagName("span")[1].innerText.replace(/\./g,"")),s=parseInt(t[a].cells[getOszlopNo("gazdType")].getElementsByTagName("span")[2].innerText.replace(/\./g,""));if(r>e||r<krintp2||l>e||l<krintp2||s>e||s<krintp2)var o=!0;else o=!1;halmaz(n,o)?t[a].setAttribute("style","display:line"):t[a].setAttribute("style","display:none")}szamlal()}catch(e){alert("Hiba\n"+e)}}function prettyNumberPrint(e){var t=e.toLocaleString().match(/[0-9]+/g).join(".");return e<0?"-"+t:t}function load(){try{if(displayMessage("Gazdasági analízis nézet",'<form name="gazdForm"><table id="gazdViewTable" cellspacing="0" cellpadding="5">\t\t<tr><td>Eredeti nézet</td><td><input type="radio" name="gazdType" value="ORIGINAL">Eredeti nyersanyagok mutatása</td>\t\t<tr><td>Átlaghoz képest</td><td>\t\t\t<input type="radio" name="gazdType" value="G_AVG_RELATIVE">Összes falud átlagnyerségez képest<br>\t\t\t<input type="radio" name="gazdType" checked value="AVG_RELATIVE">Aktuális falu átlagnyerséhez képest<br>\t\t\t<input type="radio" name="gazdType" value="C_AVG_RELATIVE">Jelenlegi csoport átlagnyerséhez képest<br>\t\t</td></tr>\t\t\t\t<tr><td>Üzleti nézet, 1:1 arányú<br>\t\t<select name="business_mode"><option value="local">Helyi piac</option><option value="sector">Csoport-piac</option><option value="global">Globál-piac</option></select>\t\t</td><td>\t\t  <input type="radio" name="gazdType" value="FA_BUSINESS"><span class="res wood">&nbsp;&nbsp;&nbsp;&nbsp;</span> Fát akarok venni<br>\t\t  <input type="radio" name="gazdType" value="AGYAG_BUSINESS"><span class="res stone">&nbsp;&nbsp;&nbsp;&nbsp;</span> Agyagot akarok venni<br>\t\t  <input type="radio" name="gazdType" value="VAS_BUSINESS"><span class="res iron">&nbsp;&nbsp;&nbsp;&nbsp;</span> Vasat akarok venni<br>\t\t</td></tr>\t\t\t\t<tr><td>Globális nyershez képest<br>(Globál balance)</td><td>\t\t  <input type="radio" name="gazdType" value="G_FA_RELATIVE"><span class="res wood">&nbsp;&nbsp;&nbsp;&nbsp;</span> 1 falura vetített átlagos fához képest<br>\t\t  <input type="radio" name="gazdType" value="G_AGYAG_RELATIVE"><span class="res stone">&nbsp;&nbsp;&nbsp;&nbsp;</span> 1 falura vetített átlagos agyaghoz képest<br>\t\t  <input type="radio" name="gazdType" value="G_VAS_RELATIVE"><span class="res iron">&nbsp;&nbsp;&nbsp;&nbsp;</span> 1 falura vetített átlagos vashoz képest<br>\t\t</td></tr>\t\t\t\t<tr><td>Csoport nyerséhez képest<br>(Csoport-balance)</td><td>\t\t  <input type="radio" name="gazdType" value="C_FA_RELATIVE"><span class="res wood">&nbsp;&nbsp;&nbsp;&nbsp;</span> Csoportátlagos nyerskülönbség, fa szerint<br>\t\t  <input type="radio" name="gazdType" value="C_AGYAG_RELATIVE"><span class="res stone">&nbsp;&nbsp;&nbsp;&nbsp;</span> Csoportátlagos nyerskülönbség, agyag szerint<br>\t\t  <input type="radio" name="gazdType" value="C_VAS_RELATIVE"><span class="res iron">&nbsp;&nbsp;&nbsp;&nbsp;</span> Csoportátlagos nyerskülönbség, vas szerint<br>\t\t</td></tr>\t\t</table></form>\t\t<button type="button" onclick="updateGazdView()">\t\t Nézet frissítése\t\t</button>'),document.forms.gazdForm.gazdType.value=GAZDTYPE,getOszlopNo("gazdType")>0)return;var e=document.getElementById("production_table").rows,t=document.createElement("div");for(t.innerHTML+="<a href=\"javascript:rendez(false, 'wood', 'gazdType')\"><span class=\"res wood\"></span></a>",t.innerHTML+="<a href=\"javascript:rendez(false, 'stone', 'gazdType')\"><span class=\"res stone\"></span></a>",t.innerHTML+="<a href=\"javascript:rendez(false, 'iron', 'gazdType')\"><span class=\"res iron\"></span></a>",t.innerHTML+='&nbsp;&nbsp;&nbsp;<img src="'+BASE_URL+'graphic/buildings/market.png" title="Kritikus nyersanyagkülönbségek listázása" onclick="krit()">',i=0;i<e.length;i++){e[i].cells[getOszlopNo("nyers")].style.display="none";var a=e[i].insertCell(getOszlopNo("nyers")+1);0==i&&(a.setAttribute("id","gazdType"),a.setAttribute("style","text-align:center"),a.innerHTML='<p id="gazd_title" style="margin-bottom:0">Nyersanyag különbségek</p>',a.appendChild(t))}var n=loadGazdView("AVG_RELATIVE");try{var r=e[0].insertCell(getOszlopNo("gazdType")+1);for(r.outerHTML='<th id="nyersdiagam" style="width: 300px"><a href="javascript: rendez(true, \'\', \'nyersdiagam\')"><b>Összes nyersanyag</b></a></th>',i=1;i<n.nyersek.length;i++)(r=e[i].insertCell(getOszlopNo("gazdType")+1)).style.position="relative",r.innerHTML='<div style="background-color: #0C0; height: 10px; width: '+Math.round(n.nyersek[i]/n.osszNyers[3]*300)+'px"></div><div style="position: absolute; top: 4px; left: 7px; text-shadow: 0px 0px 4px black; color:white;">'+prettyNumberPrint(n.nyersek[i])+"</div>"}catch(e){alert(e)}var l=document.createElement("div"),s=document.getElementById("content_value");l.setAttribute("align","center"),l.setAttribute("id","csoportNyers"),l.innerHTML="",s.insertBefore(l,s.childNodes[1]),(l=document.createElement("div")).setAttribute("align","center"),l.innerHTML='Összes nyersanyag: <img src="'+picT("holz")+'"> '+prettyNumberPrint(n.osszNyers[0])+' <img src="'+picT("lehm")+'"> '+prettyNumberPrint(n.osszNyers[1])+' <img src="'+picT("eisen")+'"> '+prettyNumberPrint(n.osszNyers[2]),s.insertBefore(l,s.childNodes[1]),szamlal()}catch(e){alert(e)}}function updateGazdView(){loadGazdView(document.forms.gazdForm.gazdType.value)}function loadGazdView(e){try{var t,a,n=[0,0,0,0],r=["0"],l=0;e.indexOf("AGYAG")>-1&&(l=1),e.indexOf("VAS")>-1&&(l=2);var s=document.getElementById("production_table").rows;switch(console.info(e),e){case"AVG_RELATIVE":for((n=getAllNyers(!1))[3]=0,i=1;i<s.length;i++){var o=g(s[i].cells[getOszlopNo("nyers")].childNodes);t=Math.round((o.fa+o.agyag+o.vas)/3),s[i].cells[getOszlopNo("gazdType")].innerHTML=u([o.fa-t,o.agyag-t,o.vas-t],5e4),r[i]=o.fa+o.agyag+o.vas,r[i]>n[3]&&(n[3]=r[i])}return{osszNyers:n,nyersek:r};case"G_AVG_RELATIVE":for(n=getAllNyers(!1),t=[Math.round(n[0]/(s.length-1)),Math.round(n[1]/(s.length-1)),Math.round(n[2]/(s.length-1))],i=1;i<s.length;i++){o=g(s[i].cells[getOszlopNo("nyers")].childNodes);s[i].cells[getOszlopNo("gazdType")].innerHTML=u([o.fa-t[0],o.agyag-t[1],o.vas-t[2]],5e4)}break;case"C_AVG_RELATIVE":n=getAllNyers(!0);var c=szamlal();for(t=[Math.round(n[0]/c),Math.round(n[1]/c),Math.round(n[2]/c)],i=1;i<s.length;i++)if("none"!=s[i].style.display){o=g(s[i].cells[getOszlopNo("nyers")].childNodes);s[i].cells[getOszlopNo("gazdType")].innerHTML=u([o.fa-t[0],o.agyag-t[1],o.vas-t[2]],5e4)}else s[i].cells[getOszlopNo("gazdType")].innerHTML=u([0,0,0],1);break;case"FA_BUSINESS":for(t=m(d=document.forms.gazdForm.business_mode.value),i=1;i<s.length;i++){o=g(s[i].cells[getOszlopNo("nyers")].childNodes);if("local"==d&&(t=Math.round((o.fa+o.agyag+o.vas)/3)),o.fa-t>0)s[i].cells[getOszlopNo("gazdType")].innerHTML=u([0,0,0],5e4);else{var p=[o.agyag-t,o.vas-t];s[i].cells[getOszlopNo("gazdType")].innerHTML=u([0,p[0]<0?0:p[0],p[1]<0?0:p[1]],5e4)}}break;case"AGYAG_BUSINESS":for(t=m(d=document.forms.gazdForm.business_mode.value),i=1;i<s.length;i++){o=g(s[i].cells[getOszlopNo("nyers")].childNodes);"local"==d&&(t=Math.round((o.fa+o.agyag+o.vas)/3));p=[o.fa-t,o.vas-t];o.agyag-t>0?s[i].cells[getOszlopNo("gazdType")].innerHTML=u([0,0,0],5e4):s[i].cells[getOszlopNo("gazdType")].innerHTML=u([p[0]<0?0:p[0],0,p[1]<0?0:p[1]],5e4)}break;case"VAS_BUSINESS":var d;for(t=m(d=document.forms.gazdForm.business_mode.value),i=1;i<s.length;i++){o=g(s[i].cells[getOszlopNo("nyers")].childNodes);if("local"==d&&(t=Math.round((o.fa+o.agyag+o.vas)/3)),o.vas-t>0)s[i].cells[getOszlopNo("gazdType")].innerHTML=u([0,0,0],5e4);else{p=[o.fa-t,o.agyag-t];s[i].cells[getOszlopNo("gazdType")].innerHTML=u([p[0]<0?0:p[0],p[1]<0?0:p[1],0],5e4)}}break;case"G_FA_RELATIVE":case"G_AGYAG_RELATIVE":case"G_VAS_RELATIVE":n=getAllNyers(!1),t=Math.round(n[l]/(s.length-1)),a=!0;case"C_FA_RELATIVE":case"C_AGYAG_RELATIVE":case"C_VAS_RELATIVE":for(a||(n=getAllNyers(!0),t=Math.round(n[l]/szamlal())),i=1;i<s.length;i++){o=g(s[i].cells[getOszlopNo("nyers")].childNodes);s[i].cells[getOszlopNo("gazdType")].innerHTML=u([o.fa-t,o.agyag-t,o.vas-t],5e4)}break;case"ORIGINAL":for(i=1;i<s.length;i++){o=g(s[i].cells[getOszlopNo("nyers")].childNodes);s[i].cells[getOszlopNo("gazdType")].innerHTML=u([o.fa,o.agyag,o.vas],2e5)}break;default:return void alert("Ez a nézet nem elérhető")}function g(e){return{fa:parseInt(e[0].innerHTML.replace(/[^0-9]+/g,"")),agyag:parseInt(e[2].innerHTML.replace(/[^0-9]+/g,"")),vas:parseInt(e[4].innerHTML.replace(/[^0-9]+/g,""))}}function u(e,t){return e[0]>t||e[0]<-t?e[0]="<b>"+prettyNumberPrint(e[0])+"</b>":e[0]=prettyNumberPrint(e[0]),e[1]>t||e[1]<-t?e[1]="<b>"+prettyNumberPrint(e[1])+"</b>":e[1]=prettyNumberPrint(e[1]),e[2]>t||e[2]<-t?e[2]="<b>"+prettyNumberPrint(e[2])+"</b>":e[2]=prettyNumberPrint(e[2]),'<span class="res wood">'+e[0]+'</span> <span class="res stone">'+e[1]+'</span> <span class="res iron">'+e[2]+"</span>"}function m(e){var t;if("sector"==e){var a=szamlal();return t=getAllNyers(!0),Math.round((t[0]+t[1]+t[2])/(3*a))}if("global"==e)return t=getAllNyers(!1),Math.round((t[0]+t[1]+t[2])/(3*(s.length-1)))}GAZDTYPE=e}catch(y){alert("NEM JÓÜ -- FIXME"+y)}}function getAllNyers(e){try{var t=[0,0,0],a=document.getElementById("production_table").rows;for(i=1;i<a.length;i++)if("none"!=a[i].style.display||!e){var n=a[i].cells[getOszlopNo("nyers")].childNodes;t[0]+=parseInt(n[0].innerHTML.replace(/[^0-9]+/g,"")),t[1]+=parseInt(n[2].innerHTML.replace(/[^0-9]+/g,"")),t[2]+=parseInt(n[4].innerHTML.replace(/[^0-9]+/g,""))}return t}catch(e){return console.error("Érvénytelen nyersnézet, vélhetőleg átalakított"),[0,0,0]}}function convertView(){if(game_data.player.premium&&!game_data.player.converted){var e=document.getElementById("production_table").rows,t=new Array,a=e[1].cells.length;if(/[0-9]+(\|)[0-9]+/g.test(e[1].cells[0].textContent))for(n=6;n<a;n++)t.push(n);else{t.push(0);for(var n=7;n<a;n++)t.push(n)}for(e=document.getElementById("production_table"),n=0;n<e.rows.length;n++)for(var r=t.length-1;r>-1;r--)e.rows[n].deleteCell(t[r])}}function createView(){!function(){for(var e=document.getElementById("production_table").rows,t="order=name",a="order=points",n=/(wood)(.)*(stone)(.)*(iron)/g,r="order=storage",l="order=pop",s="order=trader_available",o=[],i=0;i<e[1].cells.length;i++){var c="";e[0].cells[i].getElementsByTagName("a").length>0?e[0].cells[i].getElementsByTagName("a")[0].href.indexOf(t)>-1?c="falunev":e[0].cells[i].getElementsByTagName("a")[0].href.indexOf(a)>-1?c="pont":e[0].cells[i].getElementsByTagName("a")[0].href.indexOf(r)>-1?c="raktar":e[0].cells[i].getElementsByTagName("a")[0].href.indexOf(l)>-1?c="tanya":e[0].cells[i].getElementsByTagName("a")[0].href.indexOf(s)>-1&&(c="kereskedo"):e[1].cells[i].innerHTML.match(n)&&(c="nyers"),""===c?o.push(i):e[0].cells[i].setAttribute("id",c)}!function(t){try{e=document.getElementById("production_table");for(var a=0;a<e.rows.length;a++)for(var n=t.length-1;n>-1;n--)e.rows[a].deleteCell(t[n])}catch(e){alert(e)}}(o)}(),function(){var e=document.getElementById("production_table").rows[0].cells;e[getOszlopNo("falunev")].getElementsByTagName("a")[0].href='javascript:rendez(true, "", "falunev")',e[getOszlopNo("pont")].getElementsByTagName("a")[0].href='javascript:rendez(false, "", "pont")',e[getOszlopNo("raktar")].getElementsByTagName("a")[0].href='javascript:rendez(false, "", "raktar")',getOszlopNo("kereskedo")>-1&&(e[getOszlopNo("kereskedo")].getElementsByTagName("a")[0].href='javascript:rendez(false, "", "kereskedo")'),e[getOszlopNo("tanya")].getElementsByTagName("a")[0].href='javascript:rendez(false, "", "tanya")';var t=document.createElement("div");t.setAttribute("style","display: inline; padding-left: 7px"),t.innerHTML="<a href=\"javascript:rendez(false, 'wood', 'nyers')\"><span class=\"res wood\"></span></a>",t.innerHTML+="<a href=\"javascript:rendez(false, 'stone', 'nyers')\"><span class=\"res stone\"></span></a>",t.innerHTML+="<a href=\"javascript:rendez(false, 'iron', 'nyers')\"><span class=\"res iron\"></span></a>",e[getOszlopNo("nyers")].appendChild(t)}();var e=document.getElementById("production_table").rows[0].cells[getOszlopNo("falunev")];e.innerHTML='<a href="javascript:load();"><img width=30px" title="Gazdasági nézet: Nyerskülönbségek és diagramok" src="'+pic("gazd")+'"></a>'+e.innerHTML,game_data.player.converted=!0;var t=document.createElement("div");t.setAttribute("id","uzi"),t.setAttribute("style","display: none; width: auto; background-color: #60302b; color: yellow; position: fixed; left: 60%; top:250px; border:3px solid black; padding: 10px; z-index:10;"),document.getElementById("content_value").appendChild(t),newNode=document.createElement("csoportok"),x=document.getElementById("content_value"),x.insertBefore(newNode,x.firstChild),x.childNodes[0].innerHTML=' <table><tr><td id="tools" width="200px"></td><td style="border: 1px solid black" id="defaults" width="245px">\t<b><u>Alapértelmezett csoportok</u></b><br><br><a href=\'javascript: Dcsoport("ossz")\' title="Összes falu megjelenítése">Összes</a>&nbsp;&nbsp;\t<a href=\'javascript: Dcsoport("tanya")\' title="Tanya lakosság alapján való szűkítés">Tanya</a><img onclick=mod(1) id="D_tanya" title="" src="'+pic("e_modify")+'">&nbsp;&nbsp;\t<a href=\'javascript: Dcsoport("raktar")\' title="Raktár telítettsége alapján való szűkítés (legnagyobb értékű nyersanyag alapján)">Raktár</a><img onclick=mod(2) id="D_raktar" title="" src="'+pic("e_modify")+'">&nbsp;&nbsp;\t<a href=\'javascript: Dcsoport("pont")\' title="Pontérték alapján való listaszűkítés"\'>Pont</a><img onclick=mod(3) id="D_pont" title="" src="'+pic("e_modify")+'"><br>\t<a href=\'javascript: Dcsoport("tamad")\'><img title="Támadás alatt áll faluk kilistázása" src="'+picT("att")+'"></a>&nbsp;&nbsp;\t<a href=\'javascript: Dcsoport("regexp")\' title="Reguláris kifejezéssel megadott listaszűkítés">RegExp</a>&nbsp;&nbsp;\t<a href=\'javascript: Dcsoport("headtail")\' title="Első/utolsó X falu listázása. A jelenleg látott listával dolgozik!">Fej/Láb</a>&nbsp;&nbsp;\t<a href=\'javascript: Dcsoport("RND")\' title="Véletlenszerűen kiválaszt a listából megadott számú falut. A jelenleg látott listából választ!">RND</a>\t<img onclick=\'Dcsoport("grafgomb")\' style="cursor:pointer" alt="GG" title="Gráfgömböc" src=\''+pic("grafgomboc")+'\'>\t&nbsp;<img onclick="smasher(false)" style="cursor:pointer;width:20px" alt="FK" title="Faluhálózat/csomópont kereső" src="'+pic("smasher_finder")+'" >\t</td><td id="group" style="line-height:200%;"></td></tr></table>';var a=document.getElementById("tools");document.getElementById("defaults"),document.getElementById("group");a.innerHTML="<a href='javascript: megnyit();'><img src=\""+pic("2_all")+'" alt="N" title="Minden falu megnyitása"></a>\n        \t<img src="'+picT("barracks")+'"\ttitle="Kiképzések megnyitása"/ '+iskivalaszt("train")+' onclick=ModOpenType(this,"train")>\n\t\t\t<img src="'+picT("farm")+'"\t\ttitle="Áttekintések megnyitása"/ '+iskivalaszt("overview")+' onclick=ModOpenType(this,"overview")>\n\t\t\t<img src="'+picT("market")+'"\ttitle="Piacok megnyitása"/ '+iskivalaszt("market")+' onclick=ModOpenType(this,"market")>\n\t\t\t<img src="'+picT("main")+'"\t\ttitle="Főhadiszállások megnyitása"/ '+iskivalaszt("main")+' onclick=ModOpenType(this,"main")>\n\t\t\t<img src="'+picT("snob")+'"\t\ttitle="Akadémiák megnyitása"/ '+iskivalaszt("snob")+' onclick=ModOpenType(this,"snob")>\n            <img src="'+picT("place")+'"\ttitle="Gyülekezőhelyek/parancsok megnyitása"/ '+iskivalaszt("place")+' onclick=ModOpenType(this,"place")>\n\t\t\t<img src="'+picT("place")+'"\ttitle="Gyülekezőhelyek/sereg megnyitása"/ '+iskivalaszt("place&mode=units")+' onclick=ModOpenType(this,"place&mode=units")>\n\t\t\t<img src="'+pic("flag")+'"\ttitle="Zászlók helyének megnyitása"/ '+iskivalaszt("flags")+' onclick=ModOpenType(this,"flags")>\n\t\t\t<br><hr>\t\t\t<img src="'+pic("metszet")+'" alt="∩" onclick=sethalmaz("metszet") title="Metszetképzés. A következőleg kiválasztott csoportból csak azon faluk fognak szerepelni, amik most is láthatóak.">\t\t\t<img src="'+pic("unio")+'" alt="∪" onclick=sethalmaz("unio") title="Unióképzés. A jelenlegi listához hozzáadja a következőleg kiválasztott csoport faluit.">\t\t\t<img src="'+pic("kulonbseg")+'" alt="/" onclick=sethalmaz("kulonbseg") title="Különbségképzés. A jelenlegi listából kiveszi a következőleg kiválasztott lista faluit.">\t\t\t<img src="'+pic("negalt")+'" alt="¬" onclick=sethalmaz("negalt") title="Negációképzés. A jelenleg látott listát megfordítja.">\t\t\t<img src="'+pic("negalt2")+'" alt="¬2" onclick=sethalmaz("negalt2") title="Negáció2* képzés. Egy másik halmazműveletet is kell utána választani. Ezt követően kiválasztott csoport negáltjával fog dolgozni.\n(csoport) <művelet> negált(csoport)">\t\t\t<img src="'+pic("2_separator")+'">\t\t\t<img src="'+pic("politavolsag2")+'" alt=">>" onclick="politavolsag(false)" title="Több faluhoz mért távolságokat számít.">\t\t\t<a href=\'javascript: centerFinder();\'><img alt="HV" src="'+pic("centerSearch")+'" title="Hálózatvizsgáló"></a>\t\t\t<a href=\'javascript: warningMeter(false);\'><img alt="VI" src="'+pic("warning")+'" title="Veszély indikátor"></a>\t\t\t<br>\t\t\t<a href=\'javascript: ujcsoport();\'><img src="'+pic("uj")+'" alt="+" title="Új csoport felvétele"></a>\t\t\t<a href=\'javascript: if (KIVALASZTOTT!="") szerkeszt();\'><img alt="E"  src="'+pic("szerk")+'" title="Kiválasztott csoport szerkesztése"></a>\t\t\t<a href=\'javascript: atnevez();\'><img alt="R" src="'+pic("2_rename")+'" title="Kiválasztott csoport átnevezése"></a>\t\t\t<a href=\'javascript: torol();\'><img alt="X" src="'+pic("2_delete")+'" title="Kiválasztott csoport törlése"></a>\t\t\t<img src="'+pic("2_separator")+'">\t\t\t<a href=\'javascript: mentes();\'><img alt="S" src="'+pic("save")+'" title="Jelenleg látott lista csoportba mentése"></a>\t\t\t<a href=\'javascript: szinez();\'><img alt="C" src="'+pic("colorize")+'" title="Jelenleg látott lista színezése véletlenszerű színnel"></a>\t\t\t<a href=\'javascript: kivag();\'><img alt="->" src="'+pic("cut_16")+'" title="A jelenleg nem látott falukat törli az oldal listájából, így semmi más nem fogja ezentúl látni azokat! (Az adatok nem törlődnek)"></a>\t\t\t<a href=\'javascript: massRename();\'><img alt="E" src="'+pic("rename")+'" title="Tömeges faluátnevező"></a>\t\t\t<br>            <a href=\'javascript: manager("exp");\'><img alt="Exp" src="'+pic("2_exp")+'" title="Adatok Exportálása"></a>            <a href=\'javascript: manager("imp");\'><img alt="Imp" src="'+pic("2_imp")+'" title="Adatok importálása"></a>            <a href=\'javascript: manager("del");\'><img alt="DEL" src="'+pic("2_delall")+'" title="ADATMEGSEMMISÍTÉS (minden elvész)"></a>\t\t\t<img src="'+pic("2_separator")+'">\t\t\t<a href=\'javascript: toredezett();\'><img alt="Defr" src="'+pic("defrag")+'" title="Adategyeztetés: olyan faluk törlése a csoportod lementéséből, melyek nem léteznek (mert pl. elfoglalták)"></a>\t\t\t<a href=\'javascript: addExFalu();\'><img alt="Falu+" src="'+pic("switchVillages")+'" height="16px" title="Külső faluk hozzáadása saját listádhoz"></a>',document.getElementById("production_table").rows[0].cells[0].innerHTML+=' Export &rarr; <a href="javascript: falulista_export(\'BB\');">BB</a>|<a href="javascript: falulista_export(\'ujsor\');">Soronként</a>|<a href="javascript: falulista_export(\'egysor\');">Egy sorba</a>. <a href="javascript: falulista_import()">Import</a>',document.getElementById("header_info").innerHTML+='<p style="margin: 0" id="halmazallapot">Halmazművelet: <b>---</b><br>Negált 2? <b>false</b></p>';var n=document.createElement("style");n.type="text/css",n.innerHTML=".cnc_toolTip { position: relative; }\t\t.cnc_toolTip .cnc_toolTipText { visibility: hidden; width: auto; pointer-events: none; background-color: rgba(0,0,0,0.75); color: #fff; border-radius: 6px; padding: 6px 10px 8px 8px; position: absolute; z-index: 1; bottom: 110%; left: 82px; margin-left: -60px; }\t\t.cnc_toolTip .cnc_toolTipText ul { padding-left: 20px; margin-top: 5px; margin-bottom: 0px;}\t\t.cnc_toolTip .cnc_toolTipText::after { content: ''; position: absolute; top: 100%; left: 50%; margin-left: -5px; border-width: 5px; border-style: solid; border-color: rgba(0,0,0,0.75) transparent transparent; }\t\t.cnc_toolTip.cnc_toolTip_right .cnc_toolTipText::after { left: 70% }\t\t.cnc_toolTip:hover .cnc_toolTipText { visibility: visible; }\t\t.cnc_toolTip.cnc_toolTip_middle .cnc_toolTipText { left: 0; }\t\t.cnc_toolTip.cnc_toolTip_right .cnc_toolTipText { left: inherit; right: 0; margin:0; }\t\t.tavTable td { background: initial !important; }",document.getElementById("content_value").appendChild(n);for(var r=1;r<document.getElementById("production_table").rows.length;r++){var l=document.createElement("img");l.setAttribute("onclick","szinez1(this)"),l.setAttribute("src",pic("pin")),l.setAttribute("alt","Pin It!"),l.setAttribute("title","Pin It!"),document.getElementById("production_table").rows[r].cells[0].insertBefore(l,document.getElementById("production_table").rows[r].cells[0].childNodes[0]),document.getElementById("production_table").rows[r].cells[0].setAttribute("class","cnc_toolTip"),(l=document.createElement("span")).setAttribute("class","cnc_toolTipText"),l.innerHTML="1. falu<br><strong>Csoportok:</strong><ul><li>Védő</li><li>Támadó</li><li>Nemes</li><li>Templom</li></ul>",document.getElementById("production_table").rows[r].cells[0].appendChild(l),(l=document.createElement("input")).setAttribute("type","checkbox"),l.setAttribute("style","display:none"),document.getElementById("production_table").rows[r].cells[0].insertBefore(l,document.getElementById("production_table").rows[r].cells[0].childNodes[0])}}-1==cURL.indexOf("screen=overview_villages")&&exit(0),$("#uzi").keyup((function(e){13==e.keyCode&&e.preventDefault()})),Array.prototype.max=function(){return Math.max.apply(null,this)};try{var TABHELPER,TABHELPER_LIST,openedREFS;convertView(),suti=getCookie("cnc_csoport"),null!=suti&&""!=suti||(alert("Első indítás!\n Nem érzékeltem lementett csoportleosztást."),setCookie("cnc_csoport","overview;23000;80;8500")),suti=getCookie("cnc_csoport"),suti.split(";").length<4&&(alert("Az értékelt csoportfelosztás szerkezetileg helytelen:\n"+suti+"\n\nEz a lementés törlésre kerül, és új generálódik."),setCookie("cnc_csoport","overview;23000;80;8500"));var KIVALASZTOTT="",OPENTYPE=suti.split(";")[0],ISHALMAZ="",NEG2=!1;createView();var G=document.getElementById("group"),T=document.getElementById("tools"),D=document.getElementById("defaults"),BASE_URL=document.location.href.split("game.php")[0],CONFIG=loadXMLDoc(BASE_URL+"interface.php?func=get_config"),ARCHERS=CONFIG.getElementsByTagName("archer")[0].textContent;ARCHERS="0"!=ARCHERS;var SPEED=CONFIG.getElementsByTagName("speed")[0].textContent,UNITS=CONFIG.getElementsByTagName("unit_speed")[0].textContent;frissit(),szamlal(),GAZDTYPE="AVG_RELATIVE"}catch(e){alert("Hiba indításkor \n"+e)}$(document).ready((function(){$("#uzi").draggable({handle:"#uzi_drag"}),$(":checkbox").change((function(){try{var e=getOszlopNo("falunev"),t=$(this).parent().children().index($(this));""!=KIVALASZTOTT&&e==t&&(koord=this.parentNode.innerText.match(/[0-9]+(\|)[0-9]+/g),koord=koord[koord.length-1],addFalu(koord))}catch(e){alert("Hiba bejelöléskor\n"+e)}}))}));void(0);
javascript:try{"undefined"==typeof cURL&&setOszlopIds()}catch(e){alert(e)}for(var curr_width=$("#main_layout").width(),oz=document.getElementById("production_table").getElementsByTagName("a"),BOTSTAGE=0,o=0;o<oz.length;o++)try{-1==oz[o].href.indexOf("javascript")&&oz[o].setAttribute("target","_BLANK")}catch(e){}var worker=createWorker(function(e){e.addEventListener("message",function(e){setTimeout(()=>{postMessage(e.data)},e.data.time)},!1)});function createWorker(e){var t=new Blob(["("+e.toString()+")(self)"],{type:"text/javascript"});return new Worker(window.URL.createObjectURL(t))}worker.onmessage=function(e){MOTOR_eloszto()},$("#contentContainer").prependTo("body"),$("body").children(":not(#contentContainer)").remove(),$("#ds_body").width(curr_width+200+"px").css("margin","auto").css("background","#363");var kotroStyle="\n\t#kotrogep-header.pause_mode {\n\t\tborder: 5px dotted blue;\n\t}\n";let kotroStyle_el=document.createElement("style");kotroStyle_el.textContent=kotroStyle,document.head.appendChild(kotroStyle_el);var ELEM=document.createElement("div");ELEM.setAttribute("id","kotrogep-header"),ELEM.innerHTML='<p align="center">\n\t<audio id="audio1" controls="controls" autoplay="autoplay"><source id="wavhang" src="" type="audio/wav"></audio><br>\n\t<img src="https://raw.githubusercontent.com/cncDAni2/klanhaboru/main/images/kotrogep/excavator.gif" height="221px"></p>\n\t<h1 align="center">KOTRÓGÉP</h1>\n\t<h4 align="center"><i>...és érmeverő</i></h4><br>\n\t<p style="padding-left:25px">\n\t\tMinimum nyers/falu:\n\t\t<img alt="Fa" title="Fa" src="graphic/holz.png"> <input type="text" id="fa_" size="5" value="50000">\n\t\t<img alt="Agyag" title="Agyag" src="graphic/lehm.png"> <input type="text" id="agyag_" size="5" value="50000">\n\t\t<img alt="Vas" title="Vas" src="graphic/eisen.png"> <input type="text" id="vas_" size="5" value="50000">\n\t\t&nbsp;&nbsp;&nbsp;Feltöltési mód? <input type="checkbox" onclick=set_balance()> <a onclick="javascript: alert(\'Az opció bepipálása után a BE oszlopba megjelölt falukat a script továbbra is feltölti nyersanyaggal, de ügyel arra, hogy ne léphesse túl a raktár kapacitását. Megfelelő pipálással egy jó balance hozható létre.\')">Mi ez?</a>\n\t\t&nbsp;&nbsp;&nbsp; Feltöltés a raktár kapacitásának <input type="text" size="2" id="maxup" value="80">%-áig.\n\t\tMax szállítási távolság: <input type="text" value="30" size="2" id="maxtav"> mező.\n\t\t<input id="rapid_value" size="2" value="10"> perc múlva nézem újra a falut, ha nem volt munkája.<br>\n\t\tFrissítési időköz: <input type="number" id="refreshtime" value="60"> másodperc. <button type="button" onclick="setRefresh()">Új frissítési idő beállítása</button><br><br>\n\t\t<button type="button" id="kotro_szunet" onclick="szunet_kotro()">Script szüneteltetése</button>\n\t</p>\n\t<p id="newrowarea">\n\t\t<b>Új külső falu megadása:</b>\n\t\tKoordináta <input type="text" size="7">\n\t\tKezdeti nyers\n\t\t<img alt="Fa" title="Fa" src="graphic/holz.png"> <input type="text" size="5" value="0">\n\t\t<img alt="Agyag" title="Agyag" src="graphic/lehm.png"> <input type="text" size="5" value="0">\n\t\t<img alt="Vas" title="Vas" src="graphic/eisen.png"> <input type="text" size="5" value="0">\n\t\t<input type="button" onclick=addNewRow() value="Felvisz">\n\t\t<input type="button" onclick=addMoreRow() value="Tömeges felvitel">\n\t</p>\n\t<p id="kot_uzi">\n\t\t<b>Üzenetek:</b>\n\t</p>',document.body.insertBefore(ELEM,document.body.firstChild),(ELEM=document.createElement("div")).innerHTML+='<a href="https://github.com/cncDAni2/klanhaboru" target="_BLANK">c&cDAni2 GITHub</a><p id="db"></p>',document.body.appendChild(ELEM),(ELEM=document.createElement("style")).type="text/css",ELEM.innerHTML="\n\t#kotrogep-header {\n\t\tbackground-image: linear-gradient(#FFF 0, #FFF 300px, #363);\n\t\tpadding: 10px;\n\t\tborder-radius: 10px;\n\t}\n\t#db {\n\t\tcolor: wheat;\n\t}\n",document.head.appendChild(ELEM),document.title="A KOTRÓGÉP";var tabla=document.getElementById("production_table");for(i=0;i<tabla.rows.length;i++)cell=tabla.rows[i].insertCell(0),cell.setAttribute("width","110px"),0==i?(cell.innerHTML='<b>ÉRME</b> <img onclick=pipa(\'auto\',2); title="Azon faluk bepipálása, melyek tanyaszintje max, és betelt." src="'+pic("auto")+'"><img onclick=pipa(\'all\',2); title="Összes falu bepipálása." src="'+pic("all")+'"><img onclick=pipa(\'none\',2); title="Kiszedi a pipákat." src="'+pic("none")+'"><img onclick=pipa(\'clone\',2); title="Azok falukat pipálja be, amik a BE oszlopnál már be vannak." src="'+pic("clone")+'">',cell.style.backgroundColor="#FF0"):cell.innerHTML='<input type="checkbox">',cell=tabla.rows[i].insertCell(0),cell.setAttribute("width","70px"),0==i?(cell.innerHTML='<b>KI</b> <img onclick=pipa(\'auto\',1); title="Azon faluk bepipálása, melyek tanyaszintje max, és betelt." src="'+pic("auto")+'"><img onclick=pipa(\'all\',1); title="Összes falu bepipálása." src="'+pic("all")+'"><img onclick=pipa(\'none\',1); title="Kiszedi a pipákat." src="'+pic("none")+'">',cell.style.backgroundColor="#AAF"):cell.innerHTML='<input type="checkbox">',cell=tabla.rows[i].insertCell(0),cell.setAttribute("width","90px"),0==i?(cell.innerHTML='<b>BE</b> <img onclick=pipa(\'auto\',0); title="Azon faluk bepipálása, melyek tanyaszintje max, és betelt." src="'+pic("auto")+'"><img onclick=pipa(\'all\',0); title="Összes falu bepipálása." src="'+pic("all")+'"><img onclick=pipa(\'none\',0); title="Kiszedi a pipákat." src="'+pic("none")+'"><img onclick=pipa(\'clone\',0); title="Azok falukat pipálja be, amik az ÉRME oszlopnál már be vannak." src="'+pic("clone")+'">',cell.style.backgroundColor="#AAF"):cell.innerHTML='<input type="checkbox">',cell=tabla.rows[i].insertCell(0),cell.setAttribute("width","180px"),0==i?(cell.innerHTML='<b>Online</b> <button onclick="resetOnline()">Újranézés</button>',cell.style.backgroundColor="#AAF"):cell.innerHTML="Ismeretlen";function resetOnline(){const e=document.querySelector("#production_table");for(let t=1;t<e.rows.length;t++)"none"!==e.rows[t].style.display&&(e.rows[t].cells[0].innerHTML="Ismeretlen")}function getRapidValue(){return console.info("RAPID:",Math.round(parseInt(document.getElementById("rapid_value").value.replace(/[^0-9]/g,""))/2)),Math.round(parseInt(document.getElementById("rapid_value").value.replace(/[^0-9]/g,""))/2)}function setOszlopIds(e){var t;t=e?e.document.getElementById("production_table").rows:document.getElementById("production_table").rows;for(var n="order=name",a="order=points",l=/(wood)(.)*(stone)(.)*(iron)/g,o="order=storage",r="order=pop",i="order=trader_available",s=[],c=0;c<t[1].cells.length;c++){var d="";t[0].cells[c].getElementsByTagName("a").length>0?t[0].cells[c].getElementsByTagName("a")[0].href.indexOf(n)>-1?d="falunev":t[0].cells[c].getElementsByTagName("a")[0].href.indexOf(a)>-1?d="pont":t[0].cells[c].getElementsByTagName("a")[0].href.indexOf(o)>-1?d="raktar":t[0].cells[c].getElementsByTagName("a")[0].href.indexOf(r)>-1?d="tanya":t[0].cells[c].getElementsByTagName("a")[0].href.indexOf(i)>-1&&(d="kereskedo"):t[1].cells[c].innerHTML.match(l)&&(d="nyers"),""===d?s.push(c):t[0].cells[c].setAttribute("id",d)}!function(e){try{for(var n=0;n<t.length;n++)for(var a=e.length-1;a>-1;a--)t[n].deleteCell(e[a])}catch(e){db("Hiba referencia oldal nézetének átalakítása során: "+e)}}(s)}function getOszlopNo(e,t){var n;n=t?t.document.getElementById("production_table").rows[0]:document.getElementById("production_table").rows[0];for(var a=0;a<n.cells.length;a++)if(n.cells[a].getAttribute("id")==e)return a;return 0}function db(e){var t=new Date;document.getElementById("db").innerHTML+="<br>"+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()+" - "+ALLAPOT+" - "+A.document.readyState+": "+e}function addNewRow(){try{var e=document.getElementById("newrowarea").getElementsByTagName("input"),t=e[0].value;if(e[0].value="",-1==t.search(/[0-9]+(\|)[0-9]+/))throw"Nincs megadva koordináta";e[1].value=e[1].value.replace(/[^0-9]/g,""),e[2].value=e[2].value.replace(/[^0-9]/g,""),e[3].value=e[3].value.replace(/[^0-9]/g,""),addNewRow2(t,e[1].value+","+e[2].value+","+e[3].value)}catch(e){alert("Hiba felvitelkor:\n"+e)}}function addNewRow2(e,t){var n=document.getElementById("production_table").insertRow(-1);n.insertCell(0).innerHTML="Ismeretlen",n.insertCell(1).innerHTML='<input type="checkbox">',n.insertCell(2).innerHTML='<input type="checkbox" disabled>',n.insertCell(3).innerHTML='<input type="checkbox" disabled>',n.insertCell(4).innerHTML=e,n.insertCell(5).innerHTML="0",n.insertCell(6).innerHTML=t,n.insertCell(7).innerHTML="400000",n.insertCell(8).innerHTML="100/100"}function addMoreRow(){try{var e=document.getElementById("newrowarea").getElementsByTagName("input"),t=e[0].value;if(e[0].value="",-1==t.search(/[0-9]+(\|)[0-9]+/))throw"Nincs megadva koordináta";e[1].value=e[1].value.replace(/[^0-9]/g,""),e[2].value=e[2].value.replace(/[^0-9]/g,""),e[3].value=e[3].value.replace(/[^0-9]/g,"");for(var n=t.match(/[0-9]+(\|)[0-9]+/g),a=0;a<n.length;a++)addNewRow2(n[a],e[1].value+","+e[2].value+","+e[3].value)}catch(e){alert(e)}}function wopen(e){A=window.open(e,KOTROID)}function szunet_kotro(){ISPAUSE=!ISPAUSE,document.querySelector("#kotro_szunet").innerHTML=ISPAUSE?"Script folytatása":"Script szüneteltetése",document.querySelector("#kotrogep-header").classList.remove("pause_mode"),ISPAUSE&&document.querySelector("#kotrogep-header").classList.add("pause_mode")}function setRefresh(){let e=parseInt(document.querySelector("#refreshtime").value);("number"!=typeof e||isNaN(e)||e<10||e>600)&&(e=60),REFRESH_TIME=e,document.querySelector("#refreshtime").value=e}function set_balance(){(BALANCE=!BALANCE)?(tabla.rows[0].cells[1].innerHTML='<b>BE</b> <img onclick=pipa(\'auto\',0); title="Azon faluk bepipálása, melyek népességszáma 21500 alatti." src="'+pic("auto")+'"><img onclick=pipa(\'all\',0); title="Összes falu bepipálása." src="'+pic("all")+'"><img onclick=pipa(\'none\',0); title="Kiszedi a pipákat." src="'+pic("none")+'">',tabla.rows[0].cells[1].setAttribute("width","73px"),tabla.rows[0].cells[3].setAttribute("width","83px"),document.getElementsByTagName("img")[0].setAttribute("src","https://raw.githubusercontent.com/cncDAni2/klanhaboru/main/images/kotrogep/excavator2.gif")):(tabla.rows[0].cells[1].innerHTML='<b>BE</b> <img onclick=pipa("auto",0); title="Azon faluk bepipálása, melyek tanyaszintje max, és betelt." src="'+pic("auto")+'"><img onclick=pipa("all",0);\ttitle="Összes falu bepipálása." src="'+pic("all")+'"><img onclick=pipa("none",0); title="Kiszedi a pipákat." src="'+pic("none")+'"><img onclick=pipa(\'clone\',0); title="Azok falukat pipálja be, amik az ÉRME oszlopnál már be vannak." src="'+pic("clone")+'">',tabla.rows[0].cells[1].setAttribute("width","84px"),tabla.rows[0].cells[3].setAttribute("width","115px"),document.getElementsByTagName("img")[0].setAttribute("src","https://raw.githubusercontent.com/cncDAni2/klanhaboru/main/images/kotrogep/excavator.gif"))}function pic(e){return"https://raw.githubusercontent.com/cncDAni2/klanhaboru/main/images/kotrogep/kotro_"+e+".png"}function pipa(e,t){try{for(t++,i=1;i<tabla.rows.length;i++)if("none"!=tabla.rows[i].style.display)if("all"!=e)if("none"!=e){if(tanya=tabla.rows[i].cells[getOszlopNo("tanya")].innerHTML.match(/[0-9]+/g),"auto"==e)if(BALANCE&&1==t)parseInt(tanya[0])<21e3&&(tabla.rows[i].cells[t].getElementsByTagName("input")[0].checked=!0);else if(parseInt(tanya[0])>23500&&parseInt(tanya[1])-parseInt(tanya[0])<=500){if(1==t&&1==tabla.rows[i].cells[2].getElementsByTagName("input")[0].checked)continue;if(2==t&&1==tabla.rows[i].cells[1].getElementsByTagName("input")[0].checked)continue;tabla.rows[i].cells[t].getElementsByTagName("input")[0].checked=!0}"clone"==e&&(1==t&&1==tabla.rows[i].cells[3].getElementsByTagName("input")[0].checked&&(tabla.rows[i].cells[1].getElementsByTagName("input")[0].checked=!0),3==t&&1==tabla.rows[i].cells[1].getElementsByTagName("input")[0].checked&&(tabla.rows[i].cells[3].getElementsByTagName("input")[0].checked=!0))}else tabla.rows[i].cells[t].getElementsByTagName("input")[0].checked=!1;else tabla.rows[i].cells[t].getElementsByTagName("input")[0].checked=!0;return}catch(e){alert("Hiba pipáláskor: \n"+e)}}function botriado(e){e?(document.getElementsByTagName("h1")[0].innerHTML="A KOTRÓGÉP",ALLAPOT=0,PM1=0,PM2=0,PM3=0,PM4=!1,PM5=0,BOTSTAGE=0,A.document.location.reload(),document.getElementById("audio1").pause()):(++BOTSTAGE>3&&(A.document.location.reload(),BOTSTAGE=1),document.getElementsByTagName("h1")[0].innerHTML='<a href="javascript:botriado(true);">---&gt; BOT VÉDELEM AKTÍV &lt;---</a>',document.getElementById("wavhang").src="https://raw.githubusercontent.com/cncDAni2/klanhaboru/main/images/szem4/bot.wav",document.getElementById("audio1").load(),document.getElementById("audio1").play(),document.getElementById("audio1").volume<.2&&(document.getElementById("audio1").volume=.9))}function nfrissit(e,t){try{extraido=t?new Array(0,5,0):A.document.getElementById("content_value").getElementsByTagName("table")[0].rows[5].cells[1].innerHTML.match(/[0-9]+/g),0!=extraido[1]&&(extraido[1]=(extraido[1]+"").replace(/^0*/g,"")),0!=extraido[2]&&(extraido[2]=(extraido[2]+"").replace(/^0*/g,""));var n=new Date;n.setHours(n.getHours()+2*parseInt(extraido[0])),n.setMinutes(parseInt(n.getMinutes())+2*parseInt(extraido[1])+1),n.setSeconds(parseInt(n.getSeconds())+2*parseInt(extraido[2]));let a=new Date;a.setMinutes(a.getMinutes()+10),tabla.rows[e].cells[0].innerHTML=a.toLocaleString(),t||A.document.getElementById("content_value").getElementsByTagName("input")[0].click()}catch(e){db("nFrissít hiba: "+e),ALLAPOT=0}ALLAPOT=0}function illeszt(e,t){if(SIMULATION>10)return db("illeszt() - Szimuláció általi hibamegállapítás - "+SIMULATION),SIMULATION=0,void(ALLAPOT=0);try{A.document.getElementById("content_value").getElementsByTagName("table")[1].rows[0].cells[1].getElementsByTagName("table")[0].innerHTML}catch(e){return void SIMULATION++}SIMULATION=0;try{if(JAV=document.getElementById("fa_"),JAV.value=parseInt(JAV.value.replace(/[^0-9]/g,""),10),""==JAV.value&&(JAV.value="0"),JAV=document.getElementById("agyag_"),JAV.value=parseInt(JAV.value.replace(/[^0-9]/g,""),10),""==JAV.value&&(JAV.value="0"),JAV=document.getElementById("vas_"),JAV.value=parseInt(JAV.value.replace(/[^0-9]/g,""),10),""==JAV.value&&(JAV.value="0"),JAV=document.getElementById("maxtav"),JAV.value=parseInt(JAV.value.replace(/[^0-9]/g,""),10),""==JAV.value&&(JAV.value="30"),kereskedok=A.document.getElementById("content_value").getElementsByTagName("table")[1].rows[0].cells[1].getElementsByTagName("table")[0].rows[0].cells[0],kereskedok=1e3*parseInt(kereskedok.innerHTML.match(/[0-9]+/g)[0]),kereskedok<3e3)return ALLAPOT=3,void(PM4=!0);if(Fa=parseInt(A.document.getElementById("wood").innerHTML),Agyag=parseInt(A.document.getElementById("stone").innerHTML),Vas=parseInt(A.document.getElementById("iron").innerHTML),Fa-=parseInt(document.getElementById("fa_").value),Agyag-=parseInt(document.getElementById("agyag_").value),Vas-=parseInt(document.getElementById("vas_").value),Fa<0&&(Fa=0),Agyag<0&&(Agyag=0),Vas<0&&(Vas=0),Fa+Agyag+Vas<3e3)return ALLAPOT=3,void(PM4=!0);oszto=3,AVG=Math.round(kereskedok/3),Vari=new Array(!1,!1,!1),Be=new Array(AVG,AVG,AVG);var n=0;do{if(n>0){for(i=0;i<3;i++)0==Vari[i]&&(Be[i]+=Math.round(n/oszto));n=0}Be[0]>Fa&&(Vari[0]=!0,n+=Be[0]-Fa,Be[0]=Fa,oszto--),Be[1]>Agyag&&(Vari[1]=!0,n+=Be[1]-Agyag,Be[1]=Agyag,oszto--),Be[2]>Vas&&(Vari[2]=!0,n+=Be[2]-Vas,Be[2]=Vas,oszto--)}while(0!=n);for(y=0;y<Be.length;y++)0==Be[y]&&(Be[y]=1);A.document.forms.market.wood.value=Be[0]-1,A.document.forms.market.stone.value=Be[1]-1,A.document.forms.market.iron.value=Be[2]-1,A.document.forms.market.x.value=e,A.document.forms.market.y.value=t,A.document.getElementById("delivery_target").getElementsByTagName("table")[0].rows[0].cells[1].getElementsByTagName("input")[0].click(),ALLAPOT=3,PM4=!1}catch(e){db("Illesztési hiba "+e),ALLAPOT=0}}function kuld(e,t){try{var n=999,a="0",l=document.getElementById("production_table");for(Tkoord=e.match(/[0-9]+/g),i=1;i<l.rows.length;i++)1==l.rows[i].cells[1].getElementsByTagName("input")[0].checked&&(AkoordS=l.rows[i].cells[getOszlopNo("falunev")].innerText.match(/[0-9]+(\|)[0-9]+/g),Akoord=AkoordS[AkoordS.length-1].match(/[0-9]+/g),tavolsag=Math.abs(Math.sqrt(Math.pow(Tkoord[0]-Akoord[0],2)+Math.pow(Tkoord[1]-Akoord[1],2))),0!==tavolsag&&tavolsag<n&&(n=tavolsag,a=Akoord));if("0"==a)return void(ALLAPOT=0);URL=l.rows[1].cells[getOszlopNo("falunev")].getElementsByTagName("a")[0].href.replace("screen=overview","screen=market&mode=send"),URL=URL.replace(/village=[0-9]+/g,"village="+t),wopen(URL),PM1=a[0],PM2=a[1],ALLAPOT=2}catch(e){db("küld() - "+e),ALLAPOT=0}}function munka(){try{var e=new Date,t=document.getElementById("production_table");for(i=1;i<t.rows.length;i++)if(1==t.rows[i].cells[2].getElementsByTagName("input")[0].checked){if(ID=t.rows[i].cells[getOszlopNo("falunev")].getElementsByTagName("a")[0].href.match(/village=[0-9]+/g)[0].replace("village=",""),koordS=t.rows[i].cells[getOszlopNo("falunev")].innerText.match(/[0-9]+(\|)[0-9]+/g),koord=koordS[koordS.length-1],"Ismeretlen"==t.rows[i].cells[0].innerHTML)return ALLAPOT=1,PM1=koord,PM2=ID,void(PM3=i);if(online=new Date(t.rows[i].cells[0].innerHTML),online-e<0)return ALLAPOT=1,PM1=koord,PM2=ID,void(PM3=i)}0==ALLAPOT&&(ERME=!0)}catch(e){db("munka() - "+e),ALLAPOT=0}}function open_attek(){try{return A.document.location.href!=document.location.href&&wopen(document.location.href),void(ALLAPOT=1)}catch(e){db("áttekintés megnyitása - "+e)}}function open_academy(){try{setOszlopIds(A),ERME=!1,ALLAPOT=0;var e=A.document.getElementById("production_table");for(let n=1;n<tabla.rows.length;n++)if(1==tabla.rows[n].cells[3].getElementsByTagName("input")[0].checked){faluID=tabla.rows[n].cells[getOszlopNo("falunev")].getElementsByTagName("a")[0].href.match(/village=[0-9]+/g)[0].replace("village=","");for(var t=1;t<e.rows.length;t++)e.rows[t].cells[getOszlopNo("falunev",A)].getElementsByTagName("a")[0].href.match(/village=[0-9]+/g)[0].replace("village=","")==faluID&&(M=e.rows[t].cells[getOszlopNo("nyers",A)].childNodes,fa=parseInt(M[0].innerHTML.replace(/[^0-9]+/g,"")),agyag=parseInt(M[2].innerHTML.replace(/[^0-9]+/g,"")),vas=parseInt(M[4].innerHTML.replace(/[^0-9]+/g,"")),fa>28e3&&agyag>3e4&&vas>25e3&&(ALLAPOT=2,ERME=!0,PM1=n,wopen(e.rows[t].cells[getOszlopNo("falunev",A)].getElementsByTagName("a")[0].getAttribute("href").replace("screen=overview","screen=snob"))))}return}catch(e){db("Akademy - "+e),wopen(document.location.href)}}function erme_veres(){if(SIMULATION>10)return db("erme_veres() - Szimuláció által felderített hiba."),SIMULATION=0,void(ALLAPOT=0);try{A.document.getElementById("content_value").innerHTML}catch(e){return void SIMULATION++}SIMULATION=0;var e=document.getElementById("production_table").rows[PM1].cells[3];if("complete"==A.document.readyState)try{if(-1==A.document.location.href.indexOf("snob"))return void(ALLAPOT=0);ALLAPOT=0;var t=!1;A.document.getElementById("content_value").getElementsByTagName("table");if(A.document.getElementById("content_value").innerHTML.length>3e3){if(t=!0,!(parseInt(A.document.getElementById("stone").textContent)>3e4&&parseInt(A.document.getElementById("wood").textContent)>28e3&&parseInt(A.document.getElementById("iron").textContent)>25e3))return void(ALLAPOT=0);if(A.document.getElementById("coin_mint_fill_max")&&A.document.getElementById("coin_mint_fill_max").click(),A.$("input:submit").length>0)A.$("input:submit")[0].click(),document.getElementById("production_table").rows[PM1].cells[0].innerHTML="Ismeretlen";else{var n=A.$("a.btn");n[n.length-1].click()}""!=e.innerText&&(elem=e.getElementsByTagName("b")[0]).parentNode.removeChild(elem),ALLAPOT=2}t?""!=e.innerText&&(elem=e.getElementsByTagName("b")[0]).parentNode.removeChild(elem):(""==e.innerText?(newB=document.createElement("b"),newB.innerHTML="1",e.appendChild(newB)):e.getElementsByTagName("b")[0].innerHTML=parseInt(e.getElementsByTagName("b")[0].innerHTML)+1,"4"==e.innerText&&(e.getElementsByTagName("input")[0].checked=!1,(elem=e.getElementsByTagName("b")[0]).parentNode.removeChild(elem),pmkoord=document.getElementById("production_table").rows[PM1].cells[getOszlopNo("falunev")].innerHTML,document.getElementById("kot_uzi").innerHTML+="<br>Egyik érmeverésre jelölt faluban ("+pmkoord+") nem lehet érmét verni akadémia hiánya miatt, ezért a továbbiakban nem nézem.",document.getElementById("wavhang").src="https://raw.githubusercontent.com/cncDAni2/klanhaboru/main/images/kotrogep/SokNyers.wav",document.getElementById("audio1").load(),document.getElementById("audio1").play()))}catch(e){ALLAPOT=0,db("Érmeverés - "+e)}}function balance_munka(){try{var e=new Date,t=!1;for(i=1;i<tabla.rows.length;i++)if(1==tabla.rows[i].cells[1].getElementsByTagName("input")[0].checked){if(tabla.rows[i].cells[2].getElementsByTagName("input")[0].checked=!1,t=!0,tabla.rows[i].cells[2].getElementsByTagName("input")[0].disabled){tabla.rows[i].cells[0].innerHTML=e.toLocaleString();continue}if(koordS=tabla.rows[i].cells[getOszlopNo("falunev")].innerText.match(/[0-9]+(\|)[0-9]+/g),koord=koordS[koordS.length-1],URL=tabla.rows[i].cells[getOszlopNo("falunev")].getElementsByTagName("a")[0].href.replace("screen=overview","screen=market&mode=transports"),"Ismeretlen"==tabla.rows[i].cells[0].innerHTML)return ALLAPOT=1,PM1=i,PM4=!0,void wopen(URL);if(online=new Date(tabla.rows[i].cells[0].innerHTML),online-e<0)return ALLAPOT=1,PM1=i,PM4=!0,void wopen(URL)}if(!t)return void(0==ALLAPOT&&(ERME=!0));for(i=1;i<tabla.rows.length;i++)if(1==tabla.rows[i].cells[2].getElementsByTagName("input")[0].checked){if(tabla.rows[i].cells[1].getElementsByTagName("input")[0].checked=!1,ID=tabla.rows[i].cells[getOszlopNo("falunev")].getElementsByTagName("a")[0].href.match(/village=[0-9]+/g)[0].replace("village=",""),koordS=tabla.rows[i].cells[getOszlopNo("falunev")].innerText.match(/[0-9]+(\|)[0-9]+/g),koord=koordS[koordS.length-1],URL=tabla.rows[i].cells[getOszlopNo("falunev")].getElementsByTagName("a")[0].href.replace("screen=overview","screen=market&mode=send"),"Ismeretlen"==tabla.rows[i].cells[0].innerHTML)return ALLAPOT=1,PM1=i,PM2=koord,PM4=!1,void wopen(URL);if(online=new Date(tabla.rows[i].cells[0].innerHTML),online-e<0)return ALLAPOT=1,PM1=i,PM2=koord,PM4=!1,void wopen(URL)}0==ALLAPOT&&(ERME=!0)}catch(e){db("balance_munka() - "+e)}}function balance_adatszedo(){try{if(!PM4){if(PM3=0,PM4=new Array(0,0,0),JAV=document.getElementById("fa_"),JAV.value=parseInt(JAV.value.replace(/[^0-9]/g,""),10),""==JAV.value&&(JAV.value="0"),JAV=document.getElementById("agyag_"),JAV.value=parseInt(JAV.value.replace(/[^0-9]/g,""),10),""==JAV.value&&(JAV.value="0"),JAV=document.getElementById("vas_"),JAV.value=parseInt(JAV.value.replace(/[^0-9]/g,""),10),""==JAV.value&&(JAV.value="0"),JAV=document.getElementById("maxtav"),JAV.value=parseInt(JAV.value.replace(/[^0-9]/g,""),10),""==JAV.value&&(JAV.value="30"),kereskedok=A.document.getElementById("content_value").getElementsByTagName("table")[1].rows[0].cells[1].getElementsByTagName("table")[0].rows[0].cells[0],kereskedok=1e3*parseInt(kereskedok.innerHTML.match(/[0-9]+/g)[0]),kereskedok<8e3)return ALLAPOT=2,PM3=30,void(PM2=0);if(Fa=parseInt(A.document.getElementById("wood").innerHTML),Agyag=parseInt(A.document.getElementById("stone").innerHTML),Vas=parseInt(A.document.getElementById("iron").innerHTML),Fa-=parseInt(document.getElementById("fa_").value),Agyag-=parseInt(document.getElementById("agyag_").value),Vas-=parseInt(document.getElementById("vas_").value),Fa<0&&(Fa=0),Agyag<0&&(Agyag=0),Vas<0&&(Vas=0),Fa+Agyag+Vas<8e3)return ALLAPOT=2,PM3=45,void(PM2=0);var e=new Array(Fa,Agyag,Vas);for(E=0;E<3;E++)e[E]=parseInt(e[E]);var t=new Array,n=new Array,a=new Array,l=document.getElementById("production_table");for(E=1;E<l.rows.length;E++)if(1==l.rows[E].cells[1].getElementsByTagName("input")[0].checked){koordS=l.rows[E].cells[getOszlopNo("falunev")].innerText.match(/[0-9]+(\|)[0-9]+/g),koord=koordS[koordS.length-1],t.push(koord),a.push(E),Akoord=koord.split("|"),Tkoord=PM2.split("|");var o=Math.abs(Math.sqrt(Math.pow(Tkoord[0]-Akoord[0],2)+Math.pow(Tkoord[1]-Akoord[1],2)));n.push(o)}for(var r=0;r<t.length;r++){for(var i=r,s=r;s<t.length;s++)n[i]>n[s]&&(i=s);if(n[i]>parseInt(document.getElementById("maxtav").value))break;seged=n[r],n[r]=n[i],n[i]=seged,seged=t[r],t[r]=t[i],t[i]=seged,seged=a[r],a[r]=a[i],a[i]=seged;var c=document.getElementById("production_table").rows[a[r]].cells[getOszlopNo("nyers")].innerHTML.split(",");for(E=0;E<3;E++)c[E]=parseInt(c[E]);try{var d=parseInt(document.getElementById("maxup").value.match(/[0-9]+/g)[0]);document.getElementById("maxup").value=d}catch(e){document.getElementById("maxup").value="80";d=80}d/=100;var u=parseInt(document.getElementById("production_table").rows[a[r]].cells[getOszlopNo("raktar")].innerHTML);for(E=0;E<3;E++)c[E]=Math.round(u*d)-c[E],c[E]<0&&(c[E]=0);if(!((v=Math.round(c[0]+c[1]+c[2]))<5e3||v<Math.round(.25*kereskedok))){for(var m=new Array(!0,!0,!0),g=0,p=0,y=3,b=new Array(Math.round(kereskedok/3)-1,Math.round(kereskedok/3)-1,Math.round(kereskedok/3)-1),k=0;k<3;k++){p=0;for(E=0;E<3;E++)m[E]&&(c[E]<b[E]||e[E]<b[E])&&(m[E]=!1,y--,g=c[E]<e[E]?c[E]:e[E],p+=b[E]-g,b[E]=g);if(0==y)break;for(E=0;E<3;E++)m[E]&&(b[E]+=Math.floor(p/y))}var v;if(!((v=b[0]+b[1]+b[2])<5e3||v>kereskedok))return A.document.forms.market.wood.value=b[0],A.document.forms.market.stone.value=b[1],A.document.forms.market.iron.value=b[2],A.document.forms.market.x.value=t[r].split("|")[0],A.document.forms.market.y.value=t[r].split("|")[1],A.document.getElementById("delivery_target").getElementsByTagName("table")[0].rows[0].cells[1].getElementsByTagName("input")[0].click(),PM2=a[r],PM4=b,PM5=kereskedok,void(ALLAPOT=2)}}return PM3=getRapidValue(),PM2=0,void(ALLAPOT=2)}var h=A.document.getElementById("content_value").getElementsByTagName("table")[1].getElementsByTagName("table"),T=h[h.length-1];4!==T.rows[0].cells.length&&(T=h[h.length-2]);var f=new Array(0,0,0);try{if(4==T.rows[0].cells.length){T=T.rows;for(var E=1;E<T.length;E++){var M=T[E].cells[1].textContent.replace(/\./g,"");M=(M=$.trim(M)).match(/[0-9]+/g);var L=new Array(!1,!1,!1),w=0;T[E].cells[1].innerHTML.indexOf("wood")>0&&(L[0]=!0,f[0]+=parseInt(M[w]),w++),T[E].cells[1].innerHTML.indexOf("stone")>0&&(L[1]=!0,f[1]+=parseInt(M[w]),w++),T[E].cells[1].innerHTML.indexOf("iron")>0&&(L[2]=!0,f[2]+=parseInt(M[w]),w++)}}}catch(e){f=[0,0,0]}f[0]+=parseInt(A.document.getElementById("wood").textContent),f[1]+=parseInt(A.document.getElementById("stone").textContent),f[2]+=parseInt(A.document.getElementById("iron").textContent),document.getElementById("production_table").rows[PM1].cells[getOszlopNo("nyers")].innerHTML=f;var I=new Date;return I.setMinutes(I.getMinutes()+15),document.getElementById("production_table").rows[PM1].cells[0].innerHTML=I.toLocaleString(),void(ALLAPOT=0)}catch(e){db("balance_adatszedo() - "+e),ALLAPOT=0}}function balance_frissit(){try{const a=document.querySelector("#production_table");if(A.document.getElementById("error")&&(document.getElementById("kot_uzi").innerHTML+="<br><b>(!)</b>Hibaüzenet jött fel nyersküldéskor - "+PM2,PM3=30),!A.document.getElementById("content_value"))return PROBA>2?void(ALLAPOT=0):void PROBA++;PROBA=0,extraido=PM3>0?new Array(0,PM3,0):A.document.getElementById("content_value").getElementsByTagName("table")[0].rows[5].cells[1].innerHTML.match(/[0-9]+/g),0!=extraido[1]&&(extraido[1]=(extraido[1]+"").replace(/^0*/g,"")),0!=extraido[2]&&(extraido[2]=(extraido[2]+"").replace(/^0*/g,""));var e=new Date;e.setHours(e.getHours()+2*parseInt(extraido[0])),e.setMinutes(parseInt(e.getMinutes())+2*parseInt(extraido[1])+1),e.setSeconds(parseInt(e.getSeconds())+2*parseInt(extraido[2]));let l=PM4.reduce((e,t)=>e+t,0);if(l>999&&l<PM5-3e3)a.rows[PM1].cells[0].innerHTML="Ismeretlen";else{let e=new Date;e.setMinutes(e.getMinutes()+10),a.rows[PM1].cells[0].innerHTML=e.toLocaleString()}if(0==PM2)return void(ALLAPOT=0);for(var t=a.rows[PM2].cells[getOszlopNo("nyers")].innerHTML.split(","),n=0;n<3;n++)t[n]=parseInt(t[n]),t[n]+=PM4[n];a.rows[PM2].cells[getOszlopNo("nyers")].innerHTML=t,0==PM3&&A.document.getElementById("content_value").getElementsByTagName("input")[0].click()}catch(e){db("Frissít hiba: "+e),ALLAPOT=0}ALLAPOT=0}function MOTOR_eloszto(){try{if(!ISPAUSE){if(++AUTOUPDATE>REFRESH_TIME&&0==ALLAPOT)return AUTOUPDATE=0,wopen(document.location.href),void worker.postMessage({id:"kotro",time:500});if(A.closed)return wopen(document.location.href),ALLAPOT=0,void worker.postMessage({id:"kotro",time:500});if("complete"!=A.document.readyState)return void worker.postMessage({id:"kotro",time:500});if(A.document.getElementById("bot_check")||A.document.getElementById("popup_box_bot_protection")||A.document.getElementById("botprotection_quest")||"Bot védelem"==A.document.title){var e=new Date;return botriado(!1),document.getElementById("kot_uzi").innerHTML+="<br>BOT RIADÓ! "+e,void worker.postMessage({id:"kotro",time:1500})}if(BOTSTAGE>0&&botriado(!0),tabla=document.getElementById("production_table"),ERME)switch(ALLAPOT){case 0:open_attek();break;case 1:open_academy();break;case 2:erme_veres();break;default:ALLAPOT=0,ERME=!1}else if(BALANCE)switch(ALLAPOT){case 0:balance_munka();break;case 1:balance_adatszedo(PM1,PM4);break;case 2:balance_frissit(PM1,PM2);break;default:ALLAPOT=0}else switch(ALLAPOT){case 0:munka();break;case 1:kuld(PM1,PM2);break;case 2:illeszt(PM1,PM2);break;case 3:nfrissit(PM3,PM4);break;default:ALLAPOT=0}}}catch(e){try{db("eloszto -- "+e),wopen(document.location.href)}catch(e){}}rand=Math.floor(500*Math.random())+500,worker.postMessage({id:"kotro",time:rand})}var ALLAPOT=0,PM1=0,PM2=0,PM3=0,PM4=!1,PM5=0,ERME=!1,AUTOUPDATE=0,BALANCE=!1,PROBA=0,SIMULATION=0,REFRESH_TIME=60,ISPAUSE=!1,KOTROID="kotrogep"+(new Date).getTime();wopen(document.location.href),document.getElementById("wavhang").src="https://raw.githubusercontent.com/cncDAni2/klanhaboru/main/images/szem4/bot.wav",document.getElementById("audio1").load(),document.getElementById("audio1").pause(),MOTOR_eloszto(),$("#production_table tbody tr td:first-child").dblclick(function(){this.innerHTML="Ismeretlen"});